# 叫号排序规则测试用例

## 3.2.8 叫号队列排序规则测试用例

| 用例编号 | 测试用例名称 | 测试步骤 | 预期结果 | 实际结果 | 通过/失败 |
|---------|------------|---------|---------|---------|---------|
| QUEUE-001 | 提前签到按挂号序号排序 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号<br>3. 患者2预约：挂号序号2号<br>4. 患者3预约：挂号序号3号<br>5. 患者2提前签到（7:50）<br>6. 患者1提前签到（7:45）<br>7. 患者3提前签到（7:55）<br>8. 查看叫号队列 | 队列顺序：1号 → 2号 → 3号<br>（按挂号序号排序，与签到时间无关） | | |
| QUEUE-002 | 时段内签到按签到时间排序 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号<br>3. 患者2预约：挂号序号2号<br>4. 患者3预约：挂号序号3号<br>5. 患者2时段内签到（8:05）<br>6. 患者1时段内签到（8:10）<br>7. 患者3时段内签到（8:08）<br>8. 查看叫号队列 | 队列顺序：2号 → 3号 → 1号<br>（按签到时间排序：8:05 → 8:08 → 8:10） | | |
| QUEUE-003 | 提前签到与时段内签到混合排序 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（提前签到7:55）<br>3. 患者2预约：挂号序号2号（提前签到7:50）<br>4. 患者3预约：挂号序号3号（时段内签到8:05）<br>5. 患者4预约：挂号序号4号（时段内签到8:02）<br>6. 查看叫号队列 | 队列顺序：1号 → 2号 → 4号 → 3号<br>（提前签到的1、2号在前按序号，时段内签到的4、3号在后按时间） | | |
| QUEUE-004 | 按时签到正常排序 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（按时提前签到7:55）<br>3. 患者2预约：挂号序号2号（按时时段内签到8:05）<br>4. 患者3预约：挂号序号3号（按时提前签到7:50）<br>5. 查看叫号队列 | 队列顺序：1号 → 3号 → 2号<br>（按时签到的患者正常排序：提前按序号，时段内按时间） | | |
| QUEUE-005 | 迟到签到排在队尾 | 1. 创建排班：时段8:00-12:00，签到截止时间11:50<br>2. 患者1预约：挂号序号1号（按时签到8:00）<br>3. 患者2预约：挂号序号2号（按时签到8:05）<br>4. 患者3预约：挂号序号3号（迟到签到11:55）<br>5. 患者4预约：挂号序号4号（按时签到8:10）<br>6. 查看叫号队列 | 队列顺序：1号 → 2号 → 4号 → 3号<br>（按时签到的1、2、4号在前，迟到签到的3号排在队尾） | | |
| QUEUE-006 | 过号后重新签到排在队尾 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（按时签到8:00）<br>3. 患者2预约：挂号序号2号（按时签到8:05）<br>4. 患者1被叫号（8:30）<br>5. 患者1过号（未到诊室）<br>6. 医生标记患者1过号<br>7. 患者1重新扫码签到（8:45）<br>8. 查看叫号队列 | 队列顺序：2号 → 1号<br>（患者1过号后重新签到，排在当前时段队尾） | | |
| QUEUE-007 | 多个过号患者按重新签到时间排序 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（按时签到8:00）<br>3. 患者2预约：挂号序号2号（按时签到8:05）<br>4. 患者1被叫号后过号，重新签到（8:45）<br>5. 患者2被叫号后过号，重新签到（8:50）<br>6. 查看叫号队列 | 队列顺序：1号 → 2号<br>（过号患者按重新签到时间排序：8:45 → 8:50） | | |
| QUEUE-008 | 综合场景：提前+时段内+迟到+过号 | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（提前签到7:55）<br>3. 患者2预约：挂号序号2号（时段内签到8:05）<br>4. 患者3预约：挂号序号3号（按时签到8:10）<br>5. 患者4预约：挂号序号4号（迟到签到11:55）<br>6. 患者1被叫号后过号，重新签到（8:45）<br>7. 查看叫号队列 | 队列顺序：1号 → 2号 → 3号 → 4号 → 1号（过号）<br>（按时签到的1、2、3号在前，迟到签到的4号在中间，过号重新签到的1号在最后） | | |
| QUEUE-009 | 提前签到边界测试（时段开始前1分钟） | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（提前签到7:59）<br>3. 患者2预约：挂号序号2号（提前签到7:58）<br>4. 查看叫号队列 | 队列顺序：1号 → 2号<br>（7:59和7:58都在时段开始前，按挂号序号排序） | | |
| QUEUE-010 | 时段内签到边界测试（时段开始后1分钟） | 1. 创建排班：时段8:00-12:00<br>2. 患者1预约：挂号序号1号（时段内签到8:01）<br>3. 患者2预约：挂号序号2号（时段内签到8:00）<br>4. 查看叫号队列 | 队列顺序：2号 → 1号<br>（8:00和8:01都在时段开始后，按签到时间排序：8:00 → 8:01） | | |

---

## 测试场景说明

### 场景1：提前签到 vs 时段内签到

**规则说明：**
- **提前签到**（时段开始前）：按**挂号序号**排序
- **时段内签到**（时段开始后）：按**签到时间**排序（先签到先就诊）

**示例：**
- 提前签到：1号在7:45签到，2号在7:50签到 → 队列顺序：1号 → 2号（按序号）
- 时段内签到：时段8:00开始，2号在8:05签到，1号在8:10签到 → 队列顺序：2号 → 1号（按时间）

**关键点：**
- 提前签到的患者整体排在时段内签到的患者之前
- 提前签到内部按挂号序号排序
- 时段内签到内部按签到时间排序

---

### 场景2：按时签到 vs 迟到签到

**规则说明：**
- **按时签到**：正常排序（提前按序号，时段内按时间）
- **迟到签到**：排在当前时段队尾

**示例：**
- 按时签到：患者1（8:00签到）、患者2（8:05签到）→ 正常排序
- 迟到签到：患者3（11:55签到，超过签到截止时间11:50）→ 排在队尾

**关键点：**
- 按时签到的患者优先
- 迟到签到的患者统一排在队尾
- 迟到患者之间按签到时间排序

---

### 场景3：过号处理

**规则说明：**
- **定义**：医生叫号后，患者未在规定时间内到诊室
- **处理**：患者需到分诊台重新扫码签到
- **排序**：排在当前时段队尾（按重新签到时间排序）

**示例：**
- 患者1被叫号（8:30）但未到诊室
- 医生标记过号
- 患者1重新扫码签到（8:45）
- 队列顺序：其他患者 → 患者1（过号，排在最后）

**关键点：**
- 过号患者必须重新扫码才能重新进入队列
- 过号患者排在所有正常患者之后
- 多个过号患者按重新签到时间排序

---

## 测试数据准备

### 排班数据
- 时段：上午 08:00-12:00
- 签到时间窗口：07:30-11:50（开始前30分钟至结束前10分钟）
- 签到截止时间：11:50（时段结束前10分钟）

### 患者数据
- 患者1：挂号序号1号
- 患者2：挂号序号2号
- 患者3：挂号序号3号
- 患者4：挂号序号4号

---

## 测试执行记录

| 测试日期 | 测试人员 | 测试环境 | 测试版本 | 备注 |
|---------|---------|---------|---------|------|
| | | | | |

---

## 测试结论

- [ ] 提前签到排序规则：✅/❌
- [ ] 时段内签到排序规则：✅/❌
- [ ] 按时签到排序规则：✅/❌
- [ ] 迟到签到排序规则：✅/❌
- [ ] 过号处理排序规则：✅/❌
- [ ] 综合场景排序规则：✅/❌

**总体评价：** 

**建议：**

