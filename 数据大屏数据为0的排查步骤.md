# 数据大屏数据为0的排查步骤

## 快速诊断步骤

### 1. 检查后端服务是否运行

**方法1：查看后端控制台**
- 打开后端服务的控制台/终端
- 确认服务是否正常启动
- 查看是否有错误信息

**方法2：访问健康检查接口**
- 在浏览器访问：`http://localhost:8080/swagger-ui.html`
- 如果能打开 Swagger UI，说明后端服务正在运行
- 如果无法访问，说明后端服务未启动

**方法3：直接访问API**
- 在浏览器访问：`http://localhost:8080/api/dashboard/overview`
- 如果返回JSON数据，说明后端正常
- 如果显示"无法访问此网站"，说明后端未启动

---

### 2. 检查前端控制台（浏览器开发者工具）

**打开方式：**
- 按 `F12` 或 `Ctrl+Shift+I`
- 切换到 `Console`（控制台）标签
- 切换到 `Network`（网络）标签

**检查内容：**

#### Console 标签：
1. **查看是否有错误信息**
   - 红色错误：API调用失败
   - 黄色警告：一般不影响功能

2. **查看API响应日志**
   - 应该看到类似这样的日志：
     ```
     运营总览API响应: {todayAppointments: 0, activeDoctorsToday: 0, ...}
     ```
   - 如果看到 `加载数据失败` 或 `网络错误`，说明API调用失败

#### Network 标签：
1. **查看API请求**
   - 刷新页面
   - 在Network标签中查找 `overview`、`doctors`、`patients` 请求
   - 点击请求，查看：
     - **Status（状态码）**：
       - `200`：请求成功
       - `404`：接口不存在
       - `500`：服务器错误
       - `Failed` 或 `CORS error`：网络连接失败
     - **Response（响应）**：查看返回的数据

---

### 3. 检查数据库连接

**检查后端控制台日志：**
- 查看是否有数据库连接错误
- 查看是否有SQL查询错误
- 查看是否有 `=== Dashboard Stats Query ===` 的调试日志

**检查数据库配置：**
- 文件：`springboot/src/main/resources/application.yml`
- 确认：
  - 数据库地址：`jdbc:mysql://localhost:3306/hospital`
  - 用户名：`root`
  - 密码：`123456`
  - 数据库名：`hospital`

**直接查询数据库：**
```sql
-- 检查患者数据
SELECT COUNT(*) FROM patients WHERE status != 'deleted';

-- 检查预约数据
SELECT COUNT(*) FROM appointments;

-- 检查排班数据
SELECT COUNT(*) FROM schedules WHERE status = 'available';

-- 检查医生数据
SELECT COUNT(*) FROM doctors WHERE status != 'deleted';
```

---

### 4. 检查数据是否为历史数据

**问题：** 数据库中的数据可能是历史数据（如 2025-11-26, 2025-11-27），而查询的是"今天"的数据。

**解决方案：**

#### 方案1：修改系统日期（临时测试）
- 将系统日期改为数据库中有数据的日期（如 2025-11-27）
- 刷新页面查看数据

#### 方案2：修改查询逻辑（推荐）
- 修改后端查询，查询最近的数据而不是"今天"的数据
- 或者修改为查询指定日期范围的数据

---

### 5. 常见问题及解决方案

#### 问题1：后端服务未启动
**症状：** Network标签显示 `Failed` 或 `CORS error`
**解决：** 启动后端服务

#### 问题2：数据库连接失败
**症状：** 后端控制台显示数据库连接错误
**解决：** 
- 检查MySQL服务是否运行
- 检查数据库配置是否正确
- 检查数据库是否存在

#### 问题3：API返回空数据
**症状：** API返回 `{}` 或所有字段为 `0`
**解决：**
- 检查数据库中是否有数据
- 检查查询条件是否正确（如日期范围）

#### 问题4：前端未正确调用API
**症状：** Console显示 `加载数据失败`
**解决：**
- 检查 `vue_admin/src/api/dashboard.js` 中的API地址
- 确认后端服务地址为 `http://localhost:8080`

---

## 调试命令

### 检查后端服务
```bash
# Windows PowerShell
netstat -ano | findstr :8080

# 如果看到进程，说明8080端口被占用（后端可能正在运行）
```

### 检查MySQL服务
```bash
# Windows PowerShell
Get-Service | Where-Object {$_.Name -like "*mysql*"}

# 或者
net start | findstr MySQL
```

---

## 下一步操作

1. **打开浏览器开发者工具（F12）**
2. **切换到 Network 标签**
3. **刷新页面**
4. **查看 `/api/dashboard/overview` 请求**
5. **告诉我：**
   - Status 状态码是什么？
   - Response 返回了什么数据？
   - Console 中有什么错误信息？

这样我就能帮你准确定位问题了！



