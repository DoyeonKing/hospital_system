USE hopital;

SET SQL_SAFE_UPDATES = 0;

-- 1. 删除原有数据记录（注意顺序，先删有外键依赖的子表）
	SET FOREIGN_KEY_CHECKS = 0;
    TRUNCATE TABLE `symptom_synonyms`;
    TRUNCATE TABLE `symptom_department_mapping`;
    TRUNCATE TABLE `notifications`;
    TRUNCATE TABLE `audit_logs`;
    TRUNCATE TABLE `medical_guidelines`;
    TRUNCATE TABLE `leave_requests`;
    TRUNCATE TABLE `waitlist`;
    TRUNCATE TABLE `appointments`;
    TRUNCATE TABLE `schedules`;
    TRUNCATE TABLE `time_slots`;
    TRUNCATE TABLE `locations`;
    TRUNCATE TABLE `map_edges`;
    TRUNCATE TABLE `map_nodes`;
    TRUNCATE TABLE `doctors`;
    TRUNCATE TABLE `patient_profiles`;
    TRUNCATE TABLE `patients`;
    TRUNCATE TABLE `role_permissions`;
    TRUNCATE TABLE `admin_roles`;
    TRUNCATE TABLE `permissions`;
    TRUNCATE TABLE `roles`;
    TRUNCATE TABLE `admins`;
    TRUNCATE TABLE `departments`;
    TRUNCATE TABLE `parent_departments`;
	SET FOREIGN_KEY_CHECKS = 1;
-- 2. 添加父科室数据记录
INSERT INTO `parent_departments` (`name`, `description`) VALUES
('内科', '内科是临床医学的核心科室，主要诊治人体内部器官疾病，涵盖心血管、呼吸、消化、神经、内分泌等多个系统疾病，采用非手术治疗方法为主。'),
('外科', '外科是以手术治疗为主的临床科室，涵盖普通外科、骨科、神经外科、泌尿外科、胸外科等多个专业领域，处理各种创伤、肿瘤、畸形等需要手术干预的疾病。'),
('儿科', '儿科专门诊治0-18岁儿童和青少年的疾病，涵盖儿童内科、外科、新生儿科、儿童保健等专业，关注儿童生长发育和特殊疾病的诊断治疗。'),
('妇产科', '妇产科是专门诊治女性生殖系统疾病和妊娠相关疾病的临床科室，分为妇科和产科两大专业领域，涵盖女性全生命周期健康管理。');

-- 3. 添加子科室数据记录（根据提供的完整列表）
INSERT INTO `departments` (`parent_id`, `name`, `description`) VALUES
-- 内科子科室 (parent_id = 1)
(1, '神经科', '神经科主要诊治脑血管病（脑梗死、脑出血）、偏头痛、癫痫、帕金森病、阿尔茨海默病、多发性硬化、重症肌无力、周围神经病、中枢神经系统感染、睡眠障碍等神经系统疾病，提供神经电生理检查和康复治疗。'),
(1, '消化科', '消化科主要诊治胃食管反流病、消化性溃疡、胃炎、肠炎、肝炎、肝硬化、胰腺炎、胆囊炎、消化道出血、结肠息肉、炎症性肠病、功能性胃肠病等消化系统疾病，擅长内镜诊断和治疗。'),
(1, '呼吸科', '呼吸科主要诊治慢性阻塞性肺疾病、支气管哮喘、肺炎、肺结核、肺癌、肺栓塞、间质性肺疾病、支气管扩张、肺心病、呼吸衰竭、胸腔积液等呼吸系统疾病，提供呼吸支持治疗和肺康复管理。'),
(1, '心血管科', '心血管科主要诊治冠心病、高血压、心律失常、心力衰竭、心肌炎、心绞痛、心肌梗死、动脉硬化、风湿性心脏病、先天性心脏病等心血管系统疾病，擅长心脏介入手术和药物治疗。'),
(1, '内分泌科', '内分泌科主要诊治糖尿病、甲状腺疾病（甲亢、甲减、甲状腺炎）、肾上腺疾病、垂体疾病、骨质疏松症、痛风、肥胖症、代谢综合征、性腺功能障碍、生长发育异常等内分泌代谢疾病，擅长激素替代治疗和代谢管理。'),
(1, '肝病科', '肝病科主要诊治病毒性肝炎（甲肝、乙肝、丙肝）、肝硬化、脂肪肝、酒精性肝病、自身免疫性肝病、肝衰竭、肝癌、药物性肝损伤、肝囊肿等肝脏疾病，擅长肝穿刺活检和肝病综合治疗。'),
(1, '肾内科', '肾内科主要诊治急慢性肾小球肾炎、肾病综合征、肾衰竭、尿毒症、肾结石、肾囊肿、糖尿病肾病、高血压肾病、狼疮性肾炎、尿路感染、血液透析并发症等肾脏和泌尿系统疾病，提供血液透析和腹膜透析治疗。'),
(1, '普通内科', '普通内科主要诊治感冒、发热、咳嗽、腹泻、高血压、糖尿病、冠心病等常见病和多发病，提供全面的内科疾病初步诊断和综合治疗，擅长处理复杂多系统疾病。'),
(1, '血液科', '血液科主要诊治贫血（缺铁性贫血、再生障碍性贫血）、白血病、淋巴瘤、多发性骨髓瘤、骨髓增生异常综合征、血友病、血小板减少症、白细胞减少症等血液系统疾病，擅长造血干细胞移植和化疗。'),
(1, '风湿免疫科', '风湿免疫科主要诊治类风湿关节炎、系统性红斑狼疮、强直性脊柱炎、痛风性关节炎、干燥综合征、系统性硬化症、皮肌炎、血管炎、骨关节炎、骨质疏松等风湿免疫性疾病，擅长生物制剂治疗和关节功能保护。'),

-- 外科子科室 (parent_id = 2)
(2, '乳腺科', '乳腺科主要诊治乳腺增生、乳腺纤维瘤、乳腺炎、乳腺囊肿、乳腺癌、乳腺导管内乳头状瘤、男性乳腺发育等乳腺疾病，擅长乳腺微创手术和乳腺癌综合治疗。'),
(2, '心外科', '心外科主要诊治先天性心脏病（房间隔缺损、室间隔缺损）、心脏瓣膜病、冠心病需要搭桥手术者、主动脉瘤、主动脉夹层、心脏肿瘤、心包疾病等心脏疾病，擅长体外循环下心脏手术。'),
(2, '普通外科', '普通外科主要诊治甲状腺疾病、乳腺疾病、胃肠道肿瘤、阑尾炎、疝气、胆囊结石、胰腺炎、脾脏疾病、腹部外伤等普通外科疾病，擅长腹腔镜微创手术和开放手术。'),
(2, '泌尿科', '泌尿科主要诊治肾结石、输尿管结石、膀胱结石、前列腺增生、前列腺炎、前列腺癌、膀胱肿瘤、肾肿瘤、肾上腺肿瘤、尿道狭窄、泌尿系感染等泌尿系统疾病，擅长腔镜手术和碎石治疗。'),
(2, '神经脑外科', '神经脑外科主要诊治脑肿瘤、脑出血、脑外伤、脑血管畸形、脑动脉瘤、三叉神经痛、面肌痉挛、椎管内肿瘤、脑积水、颅骨缺损等神经系统疾病，擅长显微神经外科手术。'),
(2, '肛肠科', '肛肠科主要诊治痔疮、肛裂、肛瘘、肛周脓肿、直肠脱垂、便秘、结肠息肉、结直肠癌、炎症性肠病、肛门湿疹等肛肠疾病，擅长肛肠微创手术和PPH手术。'),
(2, '肝胆科', '肝胆科主要诊治肝癌、肝血管瘤、肝囊肿、胆囊结石、胆囊息肉、胆囊癌、胆管结石、胆管癌、胰腺癌、门静脉高压症等肝胆胰腺疾病，擅长肝切除和胆道手术。'),
(2, '肿瘤科', '肿瘤科主要诊治各种恶性肿瘤的综合性治疗，包括肺癌、胃癌、结直肠癌、乳腺癌、肝癌、食管癌、胰腺癌、卵巢癌等，擅长肿瘤手术、化疗、靶向治疗和免疫治疗。'),
(2, '胸外科', '胸外科主要诊治肺癌、食管癌、纵隔肿瘤、胸腺瘤、气胸、胸腔积液、胸部外伤、肋骨骨折、胸壁肿瘤、手汗症等胸部疾病，擅长胸腔镜微创手术。'),
(2, '血管科', '血管科主要诊治下肢静脉曲张、深静脉血栓、动脉硬化闭塞症、主动脉瘤、主动脉夹层、颈动脉狭窄、肾动脉狭窄、血管瘤、动静脉瘘等血管疾病，擅长血管介入治疗和开放手术。'),
(2, '男科', '男科主要诊治男性不育症、性功能障碍（阳痿、早泄）、前列腺疾病、精索静脉曲张、睾丸附睾疾病、男性性腺功能减退、男性生殖器畸形等男性生殖系统疾病，擅长显微男科手术。'),

-- 儿科子科室 (parent_id = 3)
(3, '儿科其他', '儿科其他科室主要诊治儿童疑难杂症和多系统疾病，包括儿童发热待查、生长发育迟缓、免疫功能低下、遗传代谢性疾病、罕见病等，提供儿科综合性诊疗服务。'),
(3, '内科', '儿科内科主要诊治儿童呼吸道感染、肺炎、哮喘、腹泻病、胃炎、肾炎、心肌炎、贫血、癫痫、脑炎等儿童内科疾病，擅长儿童常见病和多发病的诊断治疗。'),
(3, '外科', '儿科外科主要诊治儿童先天性畸形（先天性心脏病、唇腭裂）、儿童肿瘤、儿童外伤、阑尾炎、疝气、肠套叠、包茎、隐睾等儿童外科疾病，擅长儿童微创手术。'),
(3, '小儿口腔科', '小儿口腔科主要诊治儿童龋齿、牙髓炎、根尖周炎、牙列不齐、牙齿发育异常、口腔黏膜病、口腔外伤、舌系带过短等儿童口腔疾病，擅长儿童牙齿矫正和预防保健。'),
(3, '新生儿科', '新生儿科主要诊治早产儿、低出生体重儿、新生儿窒息、新生儿肺炎、新生儿黄疸、新生儿败血症、新生儿缺氧缺血性脑病、先天性心脏病等新生儿疾病，擅长新生儿重症监护。'),
(3, '眼科', '小儿眼科主要诊治儿童近视、远视、散光、弱视、斜视、先天性白内障、先天性青光眼、眼外伤、结膜炎、角膜炎等儿童眼病，擅长儿童视力保健和眼病治疗。'),
(3, '神经内科', '小儿神经内科主要诊治儿童癫痫、脑瘫、智力发育障碍、注意力缺陷多动障碍、抽动症、自闭症、脑炎、脑膜炎、神经肌肉病等儿童神经系统疾病，擅长儿童神经康复。'),
(3, '精神心理', '儿童精神心理科主要诊治儿童多动症、抽动症、自闭症、情绪障碍、焦虑症、抑郁症、学习困难、行为问题、睡眠障碍等儿童心理行为问题，擅长儿童心理评估和治疗。'),
(3, '耳鼻喉科', '小儿耳鼻喉科主要诊治儿童中耳炎、扁桃体炎、腺样体肥大、过敏性鼻炎、鼻窦炎、喉炎、声带息肉、先天性耳畸形、听力障碍等儿童耳鼻喉疾病，擅长儿童耳鼻喉微创手术。'),
(3, '营养保健科', '儿童营养保健科主要诊治儿童营养不良、肥胖症、生长发育迟缓、微量元素缺乏、喂养困难、食物过敏、代谢性疾病等，提供儿童营养评估和喂养指导。'),
(3, '骨科', '小儿骨科主要诊治儿童骨折、先天性髋关节脱位、先天性马蹄内翻足、脊柱侧弯、骨肿瘤、骨感染、生长痛、运动损伤等儿童骨科疾病，擅长儿童骨科矫形手术。'),

-- 妇产科子科室 (parent_id = 4)
(4, '产科', '产科主要诊治正常妊娠、高危妊娠（妊娠期高血压、妊娠期糖尿病）、胎儿发育异常、产前诊断、分娩处理、产后出血、产后恢复等围产期疾病，提供全程孕产期保健。'),
(4, '妇产科', '妇产科综合科室主要诊治妇科常见病和多发病，包括月经不调、子宫肌瘤、卵巢囊肿、宫颈疾病、盆腔炎、更年期综合征等，同时处理正常妊娠和分娩。'),
(4, '生殖医学科', '生殖医学科主要诊治不孕不育症、复发性流产、多囊卵巢综合征、子宫内膜异位症、男性不育、女性内分泌失调等生殖系统疾病，擅长辅助生殖技术（试管婴儿）。'),
(4, '计划生育', '计划生育科主要提供避孕指导、人工流产、药物流产、节育环放置取出、输卵管结扎、复通手术等计划生育服务，同时处理流产并发症和避孕相关问题。');


-- 4. 添加医生数据记录（为每个子科室分配至少2个医生）
INSERT INTO `doctors` (
    `department_id`, `identifier`, `password_hash`, `full_name`, 
    `id_card_number`, `phone_number`, `title`, `specialty`, `bio`, `photo_url`
) VALUES
-- 内科 - 神经科 (department_id = 1)1111
(1, 'D1001', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '金丽日', '110101198001010011', '+8613810010001', '主任医师', '脑血管病、偏头痛、癫痫', '神经内科专家，擅长头痛和脑血管病诊治，在急性脑梗死溶栓治疗方面经验丰富。', '/images/doctors/zhangjianguo.jpg'),
(1, 'D1002', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李延峰', '110101198102020022', '+8613810010002', '副主任医师', '帕金森病、周围神经病、睡眠障碍', '专注于运动障碍疾病和神经退行性疾病的诊断与治疗，擅长神经电生理检查。', '/images/doctors/chenjing.jpg'),

-- 内科 - 消化科 (department_id = 2)1111
(2, 'D1003', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '吴东', '110101197503030033', '+8613810010003', '主任医师', '消化性溃疡、肝硬化、炎症性肠病', '消化内镜专家，擅长胃肠道疾病内镜诊断和微创治疗，完成内镜手术数千例。', '/images/doctors/iming.jpg'),
(2, 'D1004', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '杨爱明', '110101198204040044', '+8613810010004', '副主任医师', '胃食管反流病、胰腺炎、消化道出血', '专注于功能性胃肠病和消化道早期肿瘤的内镜筛查与治疗。', '/images/doctors/wangxiaohong.jpg'),

-- 内科 - 呼吸科 (department_id = 3)1111
(3, 'D1005', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张力', '110101197805050055', '+8613810010005', '主任医师', '慢性阻塞性肺疾病、支气管哮喘、肺癌', '从事呼吸内科临床工作20年，经验丰富，擅长呼吸系统疑难疾病诊断和治疗。', '/images/doctors/liuqiang.jpg'),
(3, 'D1006', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙鹿希', '110101198506060066', '+8613810010006', '主治医师', '肺炎、肺结核、间质性肺疾病', '医学博士，擅长呼吸系统感染性疾病诊治和危重症呼吸支持治疗。', '/images/doctors/zhouwei.jpg'),

-- 内科 - 心血管科 (department_id = 4)1111
(4, 'D1007', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘淑芬', '110101197907070077', '+8613810010007', '主任医师', '冠心病、高血压、心律失常', '心血管内科专家，完成心脏介入手术千余例，擅长复杂冠心病介入治疗。', '/images/doctors/zhaomin.jpg'),
(4, 'D1008', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘彦博', '110101198108080088', '+8613810010008', '副主任医师', '心力衰竭、心肌病、心血管康复', '擅长心血管疾病药物治疗和康复指导，在慢性心力衰竭管理方面经验丰富。', '/images/doctors/sunzhiqiang.jpg'),

-- 内科 - 内分泌科 (department_id = 5)1111
(5, 'D1009', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '连小兰', '110101198309090099', '+8613810010009', '主任医师', '糖尿病、甲状腺疾病、骨质疏松', '内分泌科专家，擅长糖尿病并发症管理和甲状腺疾病诊治。', '/images/doctors/yangguang.jpg'),
(5, 'D1010', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '夏维波', '110101198410100010', '+8613810010010', '副主任医师', '肾上腺疾病、垂体疾病、肥胖症', '专注于内分泌高血压和垂体疾病的诊断与治疗。', '/images/doctors/wuxiaoli.jpg'),

-- 内科 - 肝病科 (department_id = 6)1111
(6, 'D1011', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙钢', '110101197611111111', '+8613810010011', '主任医师', '病毒性肝炎、肝硬化、肝癌', '肝病科专家，擅长肝穿刺活检和肝病综合治疗，在慢性肝病管理方面经验丰富。', '/images/doctors/wangzhiqiang.jpg'),
(6, 'D1012', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王莉瑛', '110101198712121212', '+8613810010012', '主治医师', '脂肪肝、酒精性肝病、自身免疫性肝病', '专注于代谢性肝病和遗传性肝病的诊断与治疗。', '/images/doctors/lina.jpg'),

-- 内科 - 肾内科 (department_id = 7)1111
(7, 'D1013', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘岩', '110101197012120012', '+8613810010013', '主任医师', '肾衰竭、肾病综合征、糖尿病肾病', '肾内科专家，擅长血液透析和腹膜透析治疗，在慢性肾脏病管理方面经验丰富。', '/images/doctors/zhoujianguo.jpg'),
(7, 'D1014', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '施潇潇', '110101198812120013', '+8613810010014', '副主任医师', '肾小球肾炎、尿路感染、肾结石', '专注于急性肾损伤和遗传性肾脏疾病的诊断与治疗，擅长肾穿刺活检技术。', '/images/doctors/liuxiaoyan.jpg'),

-- 内科 - 普通内科 (department_id = 8)1111
(8, 'D1015', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '徐娜', '110101197512120014', '+8613810010015', '主任医师', '高血压、糖尿病、冠心病', '普通内科专家，擅长常见病和多发病的综合诊治，在处理复杂多系统疾病方面经验丰富。', '/images/doctors/zhangwei.jpg'),
(8, 'D1016', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '黄程锦', '110101198912120015', '+8613810010016', '主治医师', '感冒、发热、咳嗽、腹泻', '专注于呼吸道感染和胃肠道感染的诊断与治疗，擅长急症的快速处理。', '/images/doctors/wangli.jpg'),

-- 内科 - 血液科 (department_id = 9)1111
(9, 'D1017', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '阮菁', '110101197612120016', '+8613810010017', '主任医师', '白血病、淋巴瘤、贫血', '血液科专家，擅长造血干细胞移植和化疗，在恶性血液病治疗方面经验丰富。', '/images/doctors/chenxiaohua.jpg'),
(9, 'D1018', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张炎', '110101198712120017', '+8613810010018', '副主任医师', '多发性骨髓瘤、血友病、血小板减少症', '专注于浆细胞疾病和出血性疾病的诊断与治疗。', '/images/doctors/liguoqing.jpg'),

-- 内科 - 风湿免疫科 (department_id = 10)1111
(10, 'D1019', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘金晶', '110101197712120018', '+8613810010019', '主任医师', '类风湿关节炎、系统性红斑狼疮、强直性脊柱炎', '风湿免疫科专家，擅长生物制剂治疗和关节功能保护，在自身免疫性疾病治疗方面经验丰富。', '/images/doctors/liuxuemei.jpg'),
(10, 'D1020', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '乔琳', '110101198812120019', '+8613810010020', '副主任医师', '痛风性关节炎、干燥综合征、血管炎', '专注于代谢性关节病和血管炎性疾病的诊断与治疗。', '/images/doctors/zhangguoqing.jpg'),

-- 外科 - 乳腺科 (department_id = 11)1111
(11, 'D2001', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙强', '110101197012120020', '+8613810010021', '主任医师', '乳腺癌、乳腺纤维瘤、乳腺炎', '乳腺科专家，擅长乳腺微创手术和乳腺癌综合治疗，完成乳腺手术数千例。', '/images/doctors/chenshuhua.jpg'),
(11, 'D2002', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '徐颖', '110101198012120021', '+8613810010022', '副主任医师', '乳腺增生、乳腺囊肿、男性乳腺发育', '专注于乳腺良性疾病的微创治疗和乳腺癌早期筛查。', '/images/doctors/liguoqiang.jpg'),

-- 外科 - 心外科 (department_id = 12)1111
(12, 'D2003', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '马国涛', '110101197112120022', '+8613810010023', '主任医师', '先天性心脏病、心脏瓣膜病、主动脉瘤', '心外科专家，擅长体外循环下心脏手术，完成心脏手术千余例。', '/images/doctors/liujianguo.jpg'),
(12, 'D2004', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '赵研学', '110101198212120023', '+8613810010024', '副主任医师', '冠心病搭桥、心脏肿瘤、心包疾病', '专注于冠脉搭桥手术和微创心脏手术。', '/images/doctors/zhangxuemei.jpg'),

-- 外科 - 普通外科 (department_id = 13)1111
(13, 'D2005', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李晓斌', '110101197212120024', '+8613810010025', '主任医师', '胃肠道肿瘤、阑尾炎、疝气', '普通外科专家，擅长腹腔镜微创手术和开放手术，完成各类手术数千例。', '/images/doctors/wangjianguo.jpg'),
(13, 'D2006', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '韦颍昕', '110101198312120025', '+8613810010026', '主治医师', '甲状腺疾病、胆囊结石、胰腺炎', '专注于甲状腺和肝胆疾病的微创手术治疗。', '/images/doctors/chenxiaoyan.jpg'),

-- 外科 - 泌尿科 (department_id = 14)1111
(14, 'D2007', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '黄钟明', '110101197312120026', '+8613810010027', '主任医师', '肾结石、前列腺增生、膀胱肿瘤', '泌尿科专家，擅长腔镜手术和碎石治疗，完成泌尿手术数千例。', '/images/doctors/zhouxiaoqiang.jpg'),
(14, 'D2008', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '周毅', '110101198412120027', '+8613810010028', '副主任医师', '输尿管结石、前列腺炎、肾上腺肿瘤', '专注于泌尿系结石和前列腺疾病的微创治疗。', '/images/doctors/lixuemei.jpg'),

-- 外科 - 神经脑外科 (department_id = 15)1111
(15, 'D2009', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '常健博', '110101197412120028', '+8613810010029', '主任医师', '脑肿瘤、脑出血、脑血管畸形', '神经脑外科专家，擅长显微神经外科手术，完成脑部手术千余例。', '/images/doctors/zhangminghua.jpg'),
(15, 'D2010', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '许志勤', '110101198512120029', '+8613810010030', '副主任医师', '三叉神经痛、面肌痉挛、椎管内肿瘤', '专注于功能神经外科和脊柱神经外科手术。', '/images/doctors/wangxiaoyan.jpg'),

-- 外科 - 肛肠科 (department_id = 16)1111
(16, 'D2011', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '徐徕', '110101197512120030', '+8613810010031', '主任医师', '痔疮、肛瘘、结直肠癌', '肛肠科专家，擅长肛肠微创手术和PPH手术，完成肛肠手术数千例。', '/images/doctors/liuxiaohua.jpg'),
(16, 'D2012', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '邱辉忠', '110101198612120031', '+8613810010032', '副主任医师', '肛裂、肛周脓肿、炎症性肠病', '专注于肛周感染性疾病和炎性肠病的外科治疗。', '/images/doctors/chenguoqing.jpg'),

-- 外科 - 肝胆科 (department_id = 17)1111
(17, 'D2013', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '杨晓波', '110101197612120032', '+8613810010033', '主任医师', '肝癌、胆囊结石、胰腺癌', '肝胆科专家，擅长肝切除和胆道手术，完成肝胆手术数千例。', '/images/doctors/wangjianhua.jpg'),
(17, 'D2014', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张磊', '110101198712120033', '+8613810010034', '副主任医师', '肝血管瘤、胆管结石、门静脉高压症', '专注于肝胆良性肿瘤和胆道疾病的微创治疗。', '/images/doctors/zhangxiaomei.jpg'),

-- 外科 - 肿瘤科 (department_id = 18)
(18, 'D2015', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张冠南', '110101197712120034', '+8613810010035', '主任医师', '肺癌、胃癌、结直肠癌', '肿瘤科专家，擅长肿瘤手术、化疗和靶向治疗，在综合治疗方面经验丰富。', '/images/doctors/lijianguo.jpg'),
(18, 'D2016', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙曦羽', '110101198812120035', '+8613810010036', '副主任医师', '乳腺癌、肝癌、食管癌', '专注于实体肿瘤的微创手术和免疫治疗。', '/images/doctors/zhouxiaoyan.jpg'),

-- 外科 - 胸外科 (department_id = 19)1111
(19, 'D2017', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王颖轶', '110101197812120036', '+8613810010037', '主任医师', '肺癌、食管癌、纵隔肿瘤', '胸外科专家，擅长胸腔镜微创手术，完成胸部手术千余例。', '/images/doctors/zhanghuaqiang.jpg'),
(19, 'D2018', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张弘', '110101198912120037', '+8613810010038', '副主任医师', '气胸、胸腔积液、胸壁肿瘤', '专注于胸膜疾病和胸壁肿瘤的外科治疗。', '/images/doctors/wangxueli.jpg'),

-- 外科 - 血管科 (department_id = 20)1111
(20, 'D2019', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '顾光超', '110101197912120038', '+8613810010039', '主任医师', '下肢静脉曲张、主动脉瘤、动脉硬化闭塞症', '血管科专家，擅长血管介入治疗和开放手术，完成血管手术千余例。', '/images/doctors/liuguoqing.jpg'),
(20, 'D2020', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '宋希涛', '110101199012120039', '+8613810010040', '副主任医师', '深静脉血栓、颈动脉狭窄、血管瘤', '专注于血管介入治疗和血管畸形的手术治疗。', '/images/doctors/chenxiaomei.jpg'),

-- 外科 - 男科 (department_id = 21)1111
(21, 'D2021', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王海', '110101198012120040', '+8613810010041', '主任医师', '男性不育症、性功能障碍、前列腺疾病', '男科专家，擅长显微男科手术，在男性生殖健康方面经验丰富。', '/images/doctors/wangzhiming.jpg'),
(21, 'D2022', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李宏军', '110101198112120041', '+8613810010042', '副主任医师', '精索静脉曲张、睾丸附睾疾病、男性性腺功能减退', '专注于男性生殖器畸形和内分泌疾病的诊治。', '/images/doctors/lixiaoyan.jpg'),

-- 儿科 - 儿科其他 (department_id = 22)1111
(22, 'D3001', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李正红', '110101197112120042', '+8613810010043', '主任医师', '儿童发热待查、生长发育迟缓、遗传代谢性疾病', '儿科专家，擅长儿童疑难杂症的诊断和治疗，在罕见病诊治方面经验丰富。', '/images/doctors/wangxiaoling.jpg'),
(22, 'D3002', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '肖娟', '110101198212120043', '+8613810010044', '副主任医师', '免疫功能低下、多系统疾病、罕见病', '专注于儿童复杂疾病和免疫缺陷病的综合治疗。', '/images/doctors/zhangguoqing2.jpg'),

-- 儿科 - 内科 (department_id = 23)1111
(23, 'D3003', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '徐艺文', '110101197312120044', '+8613810010045', '主任医师', '儿童呼吸道感染、肺炎、哮喘', '儿科内科专家，擅长儿童常见病和多发病的诊断治疗，经验丰富。', '/images/doctors/liuxiaohua2.jpg'),
(23, 'D3004', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李蕴微', '110101198412120045', '+8613810010046', '副主任医师', '腹泻病、胃炎、肾炎', '专注于儿童消化系统和泌尿系统疾病的诊治。', '/images/doctors/chenxuemei.jpg'),

-- 儿科 - 外科 (department_id = 24)1111
(24, 'D3005', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '邱正庆', '110101197412120046', '+8613810010047', '主任医师', '先天性畸形、儿童肿瘤、儿童外伤', '儿科外科专家，擅长儿童微创手术，完成儿童手术千余例。', '/images/doctors/lijianguo2.jpg'),
(24, 'D3006', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '宋红梅', '110101198512120047', '+8613810010048', '副主任医师', '阑尾炎、疝气、肠套叠', '专注于儿童急腹症和常见外科疾病的微创治疗。', '/images/doctors/wangxiaoyan2.jpg'),

-- 儿科 - 小儿口腔科 (department_id = 25)1111
(25, 'D3007', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '马明圣', '110101197512120048', '+8613810010049', '主任医师', '儿童龋齿、牙髓炎、牙列不齐', '小儿口腔科专家，擅长儿童牙齿矫正和预防保健，经验丰富。', '/images/doctors/zhangxiaoming.jpg'),
(25, 'D3008', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '全美盈', '110101198612120049', '+8613810010050', '副主任医师', '牙齿发育异常、口腔黏膜病、口腔外伤', '专注于儿童口腔疾病的全麻下治疗和预防。', '/images/doctors/lixiaoling.jpg'),

-- 儿科 - 新生儿科 (department_id = 26)1111
(26, 'D3009', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙之星', '110101197612120050', '+8613810010051', '主任医师', '早产儿、新生儿窒息、新生儿黄疸', '新生儿科专家，擅长新生儿重症监护和早产儿综合管理。', '/images/doctors/liuxiaoling2.jpg'),
(26, 'D3010', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '丁娟', '110101198712120051', '+8613810010052', '副主任医师', '新生儿肺炎、新生儿败血症、先天性心脏病', '专注于新生儿感染性疾病和先天畸形的诊断治疗。', '/images/doctors/zhangguoqing3.jpg'),

-- 儿科 - 眼科 (department_id = 27)1111
(27, 'D3011', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '苟丽娟', '110101197712120052', '+8613810010053', '主任医师', '儿童近视、弱视、斜视', '小儿眼科专家，擅长儿童视力保健和眼病治疗，经验丰富。', '/images/doctors/wangxiaohua2.jpg'),
(27, 'D3012', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王晨', '110101198812120053', '+8613810010054', '副主任医师', '先天性白内障、先天性青光眼、眼外伤', '专注于儿童先天性眼病和眼外伤的手术治疗。', '/images/doctors/chenxiaoming.jpg'),

-- 儿科 - 神经内科 (department_id = 28)1111
(28, 'D3013', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张乐嘉', '110101197812120054', '+8613810010055', '主任医师', '儿童癫痫、脑瘫、智力发育障碍', '小儿神经内科专家，擅长儿童神经系统疾病的诊断和神经康复治疗。', '/images/doctors/zhangxiaohong.jpg'),
(28, 'D3014', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '唐晓艳', '110101198912120055', '+8613810010056', '副主任医师', '注意力缺陷多动障碍、抽动症、自闭症', '专注于儿童心理行为问题和发育障碍的评估与治疗。', '/images/doctors/lixiaohua.jpg'),

-- 儿科 - 精神心理 (department_id = 29)1111
(29, 'D3015', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张玉', '110101197912120056', '+8613810010057', '主任医师', '儿童多动症、抽动症、情绪障碍', '儿童精神心理科专家，擅长儿童心理评估和治疗，经验丰富。', '/images/doctors/wangxiaoming.jpg'),
(29, 'D3016', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '简珊', '110101199012120057', '+8613810010058', '副主任医师', '焦虑症、抑郁症、学习困难', '专注于儿童情绪障碍和学习困难的综合干预。', '/images/doctors/zhangxiaoyan.jpg'),

-- 儿科 - 耳鼻喉科 (department_id = 30)1111
(30, 'D3017', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '仇万山', '110101198012120058', '+8613810010059', '主任医师', '儿童中耳炎、扁桃体炎、腺样体肥大', '小儿耳鼻喉科专家，擅长儿童耳鼻喉微创手术，经验丰富。', '/images/doctors/liuxiaoming2.jpg'),
(30, 'D3018', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李国明', '110101198112120059', '+8613810010060', '副主任医师', '过敏性鼻炎、鼻窦炎、先天性耳畸形', '专注于儿童过敏性鼻炎和先天性耳畸形的手术治疗。', '/images/doctors/wangxiaohong2.jpg'),

-- 儿科 - 营养保健科 (department_id = 31)1111
(31, 'D3019', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '丁建勇', '110101198212120060', '+8613810010061', '主任医师', '儿童营养不良、肥胖症、生长发育迟缓', '儿童营养保健科专家，擅长儿童营养评估和喂养指导，经验丰富。', '/images/doctors/zhangxiaoling.jpg'),
(31, 'D3020', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孔德红', '110101198312120061', '+8613810010062', '副主任医师', '微量元素缺乏、喂养困难、食物过敏', '专注于儿童代谢性疾病和食物过敏的营养管理。', '/images/doctors/lixiaomei.jpg'),

-- 儿科 - 骨科 (department_id = 32)1111
(32, 'D3021', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '胡莉娟', '110101198312120062', '+8613810010063', '主任医师', '儿童骨折、先天性髋关节脱位、脊柱侧弯', '小儿骨科专家，擅长儿童骨科矫形手术，经验丰富。', '/images/doctors/wangjianguo2.jpg'),
(32, 'D3022', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张玉侠', '110101198412120063', '+8613810010064', '副主任医师', '先天性马蹄内翻足、骨肿瘤、运动损伤', '专注于儿童先天性畸形和运动损伤的手术治疗。', '/images/doctors/zhangxiaoqiang.jpg'),

-- 妇产科 - 产科 (department_id = 33)1111
(33, 'D4001', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '宋英娜', '110101197512120064', '+8613810010065', '主任医师', '高危妊娠、妊娠期高血压、胎儿发育异常', '产科专家，擅长高危妊娠管理和复杂分娩处理，完成分娩数千例。', '/images/doctors/zhoulihua.jpg'),
(33, 'D4002', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙崟', '110101198612120065', '+8613810010066', '副主任医师', '正常妊娠、分娩处理、产后恢复', '专注于正常妊娠的全程管理和产后康复指导。', '/images/doctors/chenguoqing2.jpg'),

-- 妇产科 - 妇产科 (department_id = 34)1111
(34, 'D4003', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '马爽', '110101197612120066', '+8613810010067', '主任医师', '月经不调、子宫肌瘤、卵巢囊肿', '妇产科专家，擅长妇科常见病和多发病的诊治，经验丰富。', '/images/doctors/zhangaihua.jpg'),
(34, 'D4004', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘俊涛', '110101198712120067', '+8613810010068', '副主任医师', '宫颈疾病、盆腔炎、更年期综合征', '专注于妇科炎症和更年期疾病的综合治疗。', '/images/doctors/liuxiaomei2.jpg'),

-- 妇产科 - 生殖医学科 (department_id = 35)1111
(35, 'D4005', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '蒋宇林', '110101197712120068', '+8613810010069', '主任医师', '不孕不育症、复发性流产、多囊卵巢综合征', '生殖医学科专家，擅长辅助生殖技术（试管婴儿）和生殖内分泌治疗。', '/images/doctors/wangxiaohua3.jpg'),
(35, 'D4006', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '戚庆炜', '110101198812120069', '+8613810010070', '副主任医师', '子宫内膜异位症、男性不育、女性内分泌失调', '专注于不孕不育的微创手术和生殖内分泌调节。', '/images/doctors/zhangxiaoming2.jpg'),

-- 妇产科 - 计划生育 (department_id = 36)1111
(36, 'D4007', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '马良坤', '110101197812120070', '+8613810010071', '主任医师', '避孕指导、人工流产、节育环放置取出', '计划生育科专家，擅长各种计划生育手术，经验丰富。', '/images/doctors/lixiaoyan2.jpg'),
(36, 'D4008', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '高劲松', '110101198912120071', '+8613810010072', '副主任医师', '药物流产、输卵管结扎、复通手术', '专注于计划生育手术并发症的处理和避孕咨询。', '/images/doctors/wangxiaohong3.jpg');

-- 为doctors表添加title_level列
-- ALTER TABLE `doctors` 
-- ADD COLUMN `title_level` TINYINT NOT NULL DEFAULT 0 COMMENT '职称等级：0-主任医师，1-副主任医师，2-主治医师' AFTER `title`;

-- 临时禁用安全更新模式
SET SQL_SAFE_UPDATES = 0;

-- 根据现有title列的值更新title_level列
UPDATE `doctors` SET `title_level` = 0 WHERE `title` = '主任医师';
UPDATE `doctors` SET `title_level` = 1 WHERE `title` = '副主任医师';
UPDATE `doctors` SET `title_level` = 2 WHERE `title` = '主治医师';

-- 恢复安全更新模式
SET SQL_SAFE_UPDATES = 1;

INSERT INTO `symptom_department_mapping` (`symptom_keywords`, `department_id`, `priority`) VALUES
('癫痫，吐白沫，意识不清，惊叫，无力，抽搐，四肢麻痹，睡不着，抑郁，脑瘫，闹腾，头痛，睡不着，羊角风，晕倒，意识，疼痛，浑身，眼睛，眩晕，头疼，发烧，饮食，神经炎，羊癫疯，精神，肌无力，呕吐，脑膜炎，僵硬', 1, 1),
('胃炎，便秘，肚子疼痛，恶心，胃部，反酸，想吐，胀气，消化，胃病，发烧，呕吐，吃饭，胃痛，胃溃疡，拉肚子，胃胀，肠胃炎，腹痛，发病，打嗝，咳嗽，口臭，消化不良，肠胃，饮食，腹部，腹泻，胃酸，腹胀，排便，肠炎，厌食，干呕，出血，结肠炎，胀痛，食管炎，放屁，食欲', 2, 1),
('咳嗽，感冒，发烧，胸闷，肺炎，哮喘，支气管炎，胸痛，流鼻涕，肺部感染，呼吸困难，喉咙，嗓子鼻塞，肺气肿，肺纤维化，鼻涕，支气管，干咳，疼痛，气短，输液，肺大泡，发热，气喘，低烧，肺心病，高烧，消炎药，气管炎，头晕', 3, 1),
('高血压，心脏，血压，心脏病，头晕，冠心病，胸闷，头疼，心慌，高压，血压高，气短，低血压，早搏，心肌炎，心律不齐，心肌病，头痛，无力，心肌，高血脂，心绞痛，血管，感冒，发烧', 4, 1),
('糖尿病，甲亢，甲状腺炎，懒得动，痛风，疼痛，出汗，甲亢病，无力，头晕，甲状腺癌，高血糖，肥胖，肿大，消瘦，血糖高，心慌，高血压，低血糖', 5, 1),
('乙肝，肝硬化，肝炎，脂肪肝，肝脏，乙肝病毒，丙肝，酒精肝，疼痛，乏力，腹水，腹部，食欲，胆红素，肝癌', 6, 1),
('肾炎，肾病，浮肿，肾虚，食欲，尿毒症，肾结石，肾囊肿，怕冷，肾积水，肌酐，多囊肾，慢性肾炎，肾衰竭，高血压，尿频，水肿，肾小球，尿路感染，尿急，腰疼，腰痛，全身无力，蛋白尿，尿酸', 7, 1),
('头疼，胃痛，头晕，发烧，恶心，呕吐，全身无力，发热，痛风，头痛，感冒，拉肚子，咳嗽，胸闷，低烧，脱水，打嗝，酸痛，想吐，胃病，血压，尿酸', 8, 1),
('白血病，头晕，贫血，头痛，溶血，淋巴瘤，淋巴细胞，发烧，溶血性，胆固醇，败血症，淋巴', 9, 1),
('红斑狼疮，疼痛，痛风，关节，腿疼，脊柱炎，风湿病，红斑，风湿性关节炎，类风湿，关节炎，磷脂，尿酸，发烧，风湿热，酸痛，乏力，肿胀，发热', 10, 1),
('乳腺，乳房，增生，乳腺癌，硬块，肿块，胀痛，乳腺炎，囊肿，淋巴结，腺瘤，肿大，刺痛', 11, 1),
('心脏，室性早搏，心脏病，心肌病，胸闷，肋软骨，疼痛，瓣膜病，心肌，早搏，先心病，肋骨，肺炎，积液，主动脉，黑眼圈，头晕，假瘤，主动脉瓣，梗阻性，高血压', 12, 1),
('疝气，淋巴，肚子疼，疼痛，腹股沟，淋巴结，腰疼，酸痛，淋巴结炎，积液，腰酸，明显，腹膜炎，肿块，发烧，出血，阴囊，鞘膜，囊肿，胀痛，头晕，疾病，腹痛', 13, 1),
('包皮，肾结石，尿急，尿道口，尿路感染，割包皮，尿痛，输尿管，膀胱炎，水肿，出血，早泄，红肿，龟头炎，尿血，前列腺，血尿', 14, 1),
('脑梗塞，脑瘫，癫痫，头晕，头疼，脑萎缩，癫痫病，脑梗，发病，脑出血，抽风，晕眩，高血压，偏瘫，脑血栓，头痛，脑积水，抽搐，三叉神经痛，痉挛，脑病', 15, 1),
('肛门，痔疮，拉肚子，腹泻，肚子疼，外痔，内痔，呕吐，肛裂，便秘，肠梗阻，肠炎，肛瘘，肛周，瘙痒，屁股，肛肠，排便，阑尾炎，直肠，肠套叠，肠胃，尿血，肠粘连，肛肠科，脱肛，结肠炎，结肠', 16, 1),
('肝癌，胆结石，胆囊炎，肝区，胰腺癌，胆囊，胰腺炎，肝胆，恶心，腹痛，损伤，肝硬化，干呕，消瘦，胆总管，胆红素，胆管癌，呕吐，胆管炎，脓肿乙肝', 17, 1),
('肿瘤，肺癌，直肠癌，食道癌，脸色，精神状态，胃癌，宫颈癌，肝癌，卵巢癌，结肠癌，乳腺癌，化验，放疗，咳嗽，出血，淋巴癌，胰腺癌，鼻咽癌，腺癌，前列腺癌，恶心，腺瘤，淋巴瘤，淋巴结，乳腺，肿块', 18, 1),
('气胸，支气管，胸腔，扩张，积液，疼痛，咳嗽，胸闷，肿瘤，病情，胸痛，呼吸困难，睡不着，哮喘，脓胸，气短，乳糜，肋骨，积水，结核，肺癌，肺大泡，胸膜炎，右肺，感冒，发烧', 19, 1),
('血管，疼痛，静脉，舒服，脉管炎，主动脉，血管炎，淋巴，血栓性，水肿，肿胀，淋巴结，肾动脉，肿大，头晕，动脉，心肌梗死，心肌梗塞，颈动脉，紫癜，红肿，浮肿，骨折，心梗，青筋，溃疡', 20, 1),
('早泄，前列腺炎，阳痿，性功能，射精，龟头炎，尿急，疝气，瘙痒，附睾炎，钙化，尿痛，包茎，遗精，疙瘩', 21, 1),
('小儿，发烧，感冒，儿子，婴儿，女儿，缺钙，哭闹，体重，咳嗽，疫苗，高烧，拉肚子，流鼻涕，呕吐，干呕，睡眠，感染', 22, 1),
('发烧，咳嗽，小儿，感冒，哭闹，婴儿，肺炎，拉肚子，呕吐，流鼻涕，儿子，哮喘，糖尿病，高烧，女儿，腹泻，鼻涕，体温，干呕，母乳，低烧，支气管炎，退烧，退热，鼻塞，肾病，消炎药，吐奶，恶心', 23, 1),
('小儿，头晕，佝偻病，婴儿，睡不着，发烧，烫伤，下裂，尿道，小孩子，肚脐，女儿，胆道，畸形，尿床，疝气，鸡胸，尿频，外翻，脖子，进行，发病，淋巴结，感冒，肋骨', 24, 1),
('舌头，烧退，消炎药，牙龈，退烧，疙瘩，针眼，发烧，口水，发麻，边麻，牙齿，咽峡炎，食欲，流鼻涕，疱疹', 25, 1),
('新生儿，黄疸，婴儿，早产，吐奶，红点，小儿，降生，肺炎，早产儿，紫癜，发烧，肾病，溶血，疾病，儿子，发黄，哭闹，胃炎，呕吐，女儿，胆红素，感冒，窒息，生理性，贫血，拉肚子，打嗝', 26, 1),
('眼睛，斜视，流泪，出生，弱视，爱哭，视力，右眼，小儿，眼屎，视网膜，近视，眼外伤，早产儿，眼袋，肿瘤，眼角，女儿，眼压，视力下降，熬夜，病眼，流眼泪，小孩子，新生儿，眼泪，白内障，眨眼，血丝，眼镜，远视，散瞳', 27, 1),
('小儿，脑瘫，面瘫，癫痫，多动症，抽搐，癫痫病，发病，婴儿，染色体，女儿，弱智，发烧，抽动，小孩子，脑积水，惊厥，脑电图，能治，头胀，神经，注意力不集中', 28, 1),
('发颤，颤抖，失语，出汗，睡饱，嬉戏，磨擦，蹬腿', 29, 1),
('低烧，咳嗽，扁桃体炎，发烧，嗓子疼，发炎，高烧，小儿，耳屎，吞咽有点痛，嗓子眼，沙哑，幼儿，红肿，难受，哭闹，小孩子，小孩儿，脓状，婴幼儿，炎症，乏力，头痛，偏黄，咽痛，抓挠，鼻子，流脓，感冒，疼痛，鼻塞，耳鸣，胀痛，听不清，鼻涕，鼻炎，流鼻涕，吞咽困难，听力，流鼻血', 30, 1),
('小儿，拉肚子，哭闹，婴儿，腹泻，肥胖，缺钙，女儿，运动，便秘，儿子，发烧，尿床，发育，呕吐，新生儿，小孩子，不吃，感冒，恶心，遗尿', 31, 1),
('小儿，疼痛，骨折，腿疼，髋关节，骨膜炎，外翻，缺钙，女儿，小腿，手指，大骨节病，肋骨，突出，畸形，脊柱，肱骨，斜颈，肘关节', 32, 1),
('怀孕，剖腹产，疼痛，月经，孕吐，产后，羊水，流产，顺产，母乳，阴道，哺乳期，穿刺，奶水，囊肿，妊娠，早孕，回奶，胎动，女性，人流，月子，保胎，排卵期，畸形', 33, 1),
('月经，怀孕，小腹，宫颈，糜烂，怕冷，阴道，肌瘤，月经不调，瘙痒，卵巢囊肿，输卵管，宫颈炎，盆腔炎，不孕，囊肿，炎症，卵巢，乳腺，增多，息肉，积液，人流，胀痛，缓解，积水，乳头', 34, 1),
('输卵管，怀孕，结婚，堵塞，宫外孕，不孕，月经，不育，不孕症，备孕，流产，避孕措施，粘连，输精管，排卵，内分泌，早衰，试管婴儿，疼痛，积液', 35, 1),
('怀孕，人流，流产，避孕药，月经，做人流，避孕，打胎，小产，流血，堕胎，母乳喂养，肚子疼', 36, 1);


-- ============================================
-- 插入症状同义词数据（基于symptom_department_mapping扩展）
-- ============================================

-- 插入症状同义词数据
INSERT INTO `symptom_synonyms` (`symptom_keyword`, `synonym`) VALUES
-- 头痛相关
('头痛', '头疼'),
('头痛', '头昏'),
('头痛', '头部疼痛'),
('偏头痛', '偏头疼'),
('头晕', '眩晕'),
('头胀', '头部发胀'),

-- 癫痫/抽搐相关
('癫痫', '抽搐'),
('癫痫', '抽风'),
('癫痫', '羊角风'),
('癫痫', '羊癫疯'),
('惊厥', '抽风'),
('痉挛', '抽搐'),

-- 意识相关
('意识不清', '神志不清'),
('晕倒', '昏倒'),

-- 睡眠相关
('睡不着', '失眠'),
('睡眠障碍', '睡不着'),

-- 情绪/精神相关
('抑郁', '抑郁症'),
('注意力不集中', '多动'),
('多动症', '注意力不集中'),
('精神', '精神状态'),

-- 呕吐相关
('恶心', '想吐'),
('恶心', '反胃'),
('呕吐', '吐'),
('干呕', '恶心'),
('吐奶', '婴儿吐'),

-- 腹痛/胃痛相关
('腹痛', '肚子疼'),
('腹痛', '腹部疼痛'),
('肚子疼', '腹痛'),
('胃痛', '胃疼'),
('胃痛', '上腹痛'),
('胃胀', '腹胀'),
('胀痛', '胀疼'),

-- 腹泻/便秘相关
('腹泻', '拉肚子'),
('腹泻', '拉稀'),
('便秘', '大便困难'),
('排便困难', '便秘'),

-- 消化相关
('消化不良', '消化不好'),
('食欲不振', '不想吃饭'),
('食欲不振', '吃不下'),
('厌食', '不想吃'),
('口臭', '口气重'),

-- 反酸/胀气相关
('反酸', '胃酸反流'),
('胀气', '腹胀'),
('打嗝', '嗳气'),

-- 咳嗽相关
('咳嗽', '咳痰'),
('咳嗽', '干咳'),
('干咳', '咳嗽无痰'),

-- 发热相关
('发热', '发烧'),
('发热', '体温升高'),
('高烧', '高热'),
('低烧', '低热'),

-- 呼吸相关
('呼吸困难', '气短'),
('气短', '气促'),
('气短', '喘不上气'),
('气喘', '喘息'),
('胸闷', '胸部闷痛'),
('胸闷', '胸部不适'),

-- 心脏相关
('心悸', '心慌'),
('心悸', '心跳快'),
('心律不齐', '心跳不齐'),
('早搏', '期前收缩'),

-- 血压相关
('高血压', '血压高'),
('低血压', '血压低'),

-- 糖尿病相关
('多饮', '喝水多'),
('多饮', '口渴'),
('多食', '吃得多'),
('高血糖', '血糖高'),
('低血糖', '血糖低'),

-- 水肿/浮肿相关
('水肿', '浮肿'),
('水肿', '腿肿'),
('水肿', '眼肿'),
('浮肿', '水肿'),

-- 乏力相关
('乏力', '疲劳'),
('乏力', '没力气'),
('乏力', '易疲劳'),
('全身无力', '乏力'),

-- 疼痛相关（通用）
('疼痛', '痛'),
('酸痛', '酸疼'),
('胀痛', '胀疼'),
('刺痛', '针扎样痛'),

-- 关节相关
('关节疼痛', '关节痛'),
('关节疼痛', '关节肿痛'),
('关节肿胀', '关节肿'),
('关节炎', '关节发炎'),

-- 尿路相关
('尿频', '小便次数多'),
('尿急', '憋不住尿'),
('尿痛', '小便疼痛'),
('尿血', '血尿'),
('血尿', '尿中带血'),
('尿路感染', '泌尿感染'),

-- 肾相关
('腰疼', '腰痛'),
('腰酸', '腰部酸痛'),

-- 肝相关
('黄疸', '皮肤发黄'),
('黄疸', '眼睛发黄'),
('发黄', '黄疸'),

-- 淋巴结相关
('淋巴结肿大', '淋巴结大'),
('淋巴结肿大', '淋巴肿大'),
('淋巴结炎', '淋巴发炎'),

-- 视力相关
('视力下降', '看不清'),
('视力模糊', '看不清'),
('弱视', '视力差'),

-- 听力相关
('听力下降', '听不清'),
('耳鸣', '耳朵响'),

-- 鼻部相关
('鼻塞', '鼻子不通'),
('流涕', '流鼻涕'),
('流鼻涕', '鼻涕多'),
('鼻炎', '鼻子发炎'),

-- 咽喉相关
('咽喉疼痛', '嗓子疼'),
('咽喉疼痛', '喉咙疼'),
('嗓子疼', '喉咙痛'),
('咽痛', '咽喉痛'),

-- 口腔相关
('口腔溃疡', '口疮'),
('牙龈', '牙床'),
('疱疹', '水泡'),

-- 眼睛相关
('流泪', '流眼泪'),
('眼屎', '眼睛分泌物'),
('斜视', '对眼'),
('弱视', '视力低下'),

-- 皮肤相关
('皮疹', '皮肤红斑'),
('红肿', '发红肿胀'),
('瘙痒', '痒'),
('疙瘩', '小肿块'),

-- 肿块/包块相关
('肿块', '包块'),
('硬块', '肿块'),
('囊肿', '囊性包块'),
('腺瘤', '腺体肿瘤'),

-- 乳腺相关
('乳房', '乳腺'),
('乳腺', '乳房'),
('胀痛', '胀疼'),

-- 性功能相关
('性功能障碍', '阳痿'),
('性功能障碍', '早泄'),
('阳痿', '勃起障碍'),
('早泄', '射精快'),

-- 月经/妇科相关
('月经不调', '月经异常'),
('阴道', '女性生殖器'),
('瘙痒', '痒'),
('白带异常', '白带多'),

-- 妊娠/怀孕相关
('妊娠', '怀孕'),
('妊娠', '孕期'),
('怀孕', '妊娠'),
('孕吐', '妊娠呕吐'),
('流产', '小产'),
('人流', '人工流产'),

-- 不孕相关
('不孕', '不育'),
('不孕', '怀不上'),
('不孕症', '不育症'),

-- 发育相关
('生长发育迟缓', '不长个'),
('生长发育迟缓', '发育慢'),
('发育迟缓', '发育慢'),

-- 畸形相关
('畸形', '发育异常'),
('斜颈', '歪脖子'),

-- 骨折/外伤相关
('骨折', '骨头断了'),
('烫伤', '烧伤'),

-- 疝气相关
('疝气', '疝'),
('腹股沟疝', '疝气'),

-- 痔疮相关
('痔疮', '痔'),
('外痔', '外部痔疮'),
('内痔', '内部痔疮'),
('肛裂', '肛门裂伤'),

-- 儿科相关
('哭闹', '啼哭'),
('缺钙', '钙缺乏'),
('佝偻病', '维生素D缺乏'),
('尿床', '遗尿'),
('吐奶', '漾奶'),

-- 新生儿相关
('新生儿', '刚出生婴儿'),
('早产儿', '早产婴儿'),
('窒息', '呼吸暂停'),

-- 肿瘤相关
('肿瘤', '肿块'),
('癌症', '恶性肿瘤'),
('化疗', '化学治疗'),
('放疗', '放射治疗'),

-- 炎症相关
('炎症', '发炎'),
('感染', '发炎'),
('发炎', '炎症'),

-- 检查相关
('化验', '实验室检查'),
('脑电图', 'EEG'),
('肌酐', '肾功能指标'),

-- 治疗相关
('输液', '打点滴'),
('消炎药', '抗生素'),
('退烧', '退热'),

-- 行为相关
('行为问题', '不听话'),
('多动', '好动'),

-- 喂养相关
('喂养困难', '不吃奶'),
('母乳喂养', '喂母乳'),

-- 步态相关
('步态异常', '走路不正常'),

-- 活动相关
('活动受限', '动不了'),

-- 肢体相关
('肢体麻木', '手脚麻木'),
('肢体无力', '手脚没劲'),
('肢体畸形', '腿不直'),
('四肢麻痹', '四肢瘫痪'),

-- 情绪相关
('情绪异常', '易怒'),
('情绪异常', '抑郁'),
('抑郁', '忧郁'),

-- 体重相关
('消瘦', '体重下降'),
('消瘦', '变瘦'),
('肥胖', '体重增加'),
('肥胖', '发胖'),

-- 甲状腺相关
('甲状腺肿大', '脖子粗'),
('甲亢', '甲状腺功能亢进'),

-- 避孕相关
('避孕问题', '避孕咨询'),
('避孕药', '口服避孕药'),

-- 其他症状
('出汗', '冒汗'),
('怕冷', '畏寒'),
('脱水', '身体缺水'),
('脓肿', '化脓性包块'),
('积液', '液体聚集'),
('硬化', '变硬');

-- 插入患者数据
INSERT IGNORE INTO `patients` (`patient_id`, `identifier`, `patient_type`, `password_hash`, `full_name`, `phone_number`, `status`) VALUES
(1, '2021001001', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张三', '+8613810011001', 'active'),
(2, '2021001002', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李四', '+8613810011002', 'active'),
(3, '2021001003', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王五', '+8613810011003', 'active'),
(4, 'T2021001', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '赵教授', '+8613810011004', 'active'),
(5, 'T2021002', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '钱老师', '+8613810011005', 'active'),
(6, 'S2021001', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙师傅', '+8613810011006', 'active'),
(7, '2021001004', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '周小华', '+8613810011007', 'active'),
(8, '2021001005', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '吴小明', '+8613810011008', 'active'),
(9, 'T2021003', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '郑教授', '+8613810011009', 'active'),
(10, 'S2021002', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王阿姨', '+8613810011010', 'active'),
(11, '2021001006', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘洋', '+8613810011011', 'active'),
(12, '2021001007', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '陈静', '+8613810011012', 'active'),
(13, '2021001008', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '杨帆', '+8613810011013', 'active'),
(14, '2021001009', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '黄小梅', '+8613810011014', 'active'),
(15, '2021001010', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '林浩', '+8613810011015', 'active'),
(16, '2021001011', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '徐佳', '+8613810011016', 'active'),
(17, '2021001012', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '朱文', '+8613810011017', 'active'),
(18, '2021001013', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '马强', '+8613810011018', 'active'),
(19, '2021001014', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '胡雪', '+8613810011019', 'active'),
(20, '2021001015', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '郭伟', '+8613810011020', 'active'),
(21, 'T2021004', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙教授', '+8613810011021', 'active'),
(22, 'T2021005', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李老师', '+8613810011022', 'active'),
(23, 'T2021006', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '周教授', '+8613810011023', 'active'),
(24, 'T2021007', 'teacher', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '吴老师', '+8613810011024', 'active'),
(25, 'S2021003', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '赵师傅', '+8613810011025', 'active'),
(26, 'S2021004', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '钱阿姨', '+8613810011026', 'active'),
(27, 'S2021005', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '孙师傅', '+8613810011027', 'active'),
(28, 'S2021006', 'staff', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '李大叔', '+8613810011028', 'active'),
(29, '2021001016', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '高翔', '+8613810011029', 'active'),
(30, '2021001017', 'student', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '唐敏', '+8613810011030', 'active');

-- 插入患者扩展信息
INSERT IGNORE INTO `patient_profiles` (`patient_id`, `id_card_number`, `allergies`, `medical_history`, `no_show_count`, `blacklist_status`) VALUES
(1, '110101200001010011', '青霉素过敏', '无', 0, 'normal'),
(2, '110101200002020022', '无', '季节性哮喘', 1, 'normal'),
(3, '110101200003030033', '海鲜过敏', '胃炎', 0, 'normal'),
(4, '110101197001010044', '无', '高血压', 0, 'normal'),
(5, '110101197502020055', '头孢过敏', '糖尿病', 2, 'normal'),
(6, '110101196503030066', '无', '关节炎', 0, 'normal'),
(7, '110101200004040077', '花粉过敏', '无', 0, 'normal'),
(8, '110101200005050088', '无', '过敏性鼻炎', 1, 'normal'),
(9, '110101197803030099', '无', '高血脂', 0, 'normal'),
(10, '110101196904040000', '磺胺类药物过敏', '骨质疏松', 0, 'normal');

-- 插入角色数据
INSERT IGNORE INTO `roles` (`role_id`, `role_name`, `description`) VALUES
(1, 'super_admin', '超级管理员，拥有所有权限'),
(2, 'medical_admin', '医务管理员，管理医生和排班'),
(3, 'financial_admin', '财务管理员，管理收费和报表'),
(4, 'patient_admin', '患者管理员，管理患者信息'),
(5, 'system_operator', '系统操作员，日常运维');

-- 插入权限数据
INSERT IGNORE INTO `permissions` (`permission_id`, `permission_name`, `description`) VALUES
(1, 'user_manage', '用户管理权限'),
(2, 'doctor_manage', '医生管理权限'),
(3, 'patient_manage', '患者管理权限'),
(4, 'schedule_manage', '排班管理权限'),
(5, 'appointment_manage', '预约管理权限'),
(6, 'financial_manage', '财务管理权限'),
(7, 'medical_guide_manage', '就医规范管理权限'),
(8, 'system_config', '系统配置权限'),
(9, 'audit_log_view', '审计日志查看权限'),
(10, 'report_generate', '报表生成权限');

-- 插入角色权限映射
INSERT IGNORE INTO `role_permissions` (`role_id`, `permission_id`) VALUES
(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (1, 9), (1, 10),
(2, 2), (2, 4), (2, 5), (2, 9),
(3, 6), (3, 10),
(4, 3), (4, 5), (4, 9),
(5, 4), (5, 5), (5, 9);

-- 插入管理员数据
INSERT IGNORE INTO `admins` (`admin_id`, `username`, `password_hash`, `full_name`, `status`) VALUES
(1, 'admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '系统管理员', 'active'),
(2, 'zhangwei', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '张伟', 'active'),
(3, 'liumei', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '刘梅', 'active'),
(4, 'wanggang', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', '王刚', 'active');

-- 插入时间段数据
INSERT IGNORE INTO `time_slots` (`slot_id`, `slot_name`, `start_time`, `end_time`) VALUES
(1, '上午 08:00-12:00', '08:00:00', '12:00:00'),
(2, '下午 14:00-18:00', '14:00:00', '18:00:00');


-- 插入管理员角色映射
INSERT IGNORE INTO `admin_roles` (`admin_id`, `role_id`) VALUES
(1, 1),  -- 系统管理员拥有超级管理员权限
(2, 2),  -- 张伟拥有医务管理员权限
(2, 4),  -- 张伟同时拥有患者管理员权限
(3, 3),  -- 刘梅拥有财务管理员权限
(4, 5);  -- 王刚拥有系统操作员权限

-- 插入就医规范数据
INSERT IGNORE INTO `medical_guidelines` (`guideline_id`, `title`, `content`, `category`, `status`, `created_by`) VALUES
(1, '门诊就诊流程规范', '1. 预约挂号 → 2. 候诊区等待叫号 → 3. 医生诊室就诊 → 4. 缴费 → 5. 检查/取药 → 6. 离院', '就诊流程', 'active', 1),
(2, '急诊就诊须知', '急诊患者优先就诊，按病情危重程度分诊。生命危险患者立即进入抢救室。', '急诊流程', 'active', 1),
(3, '药品领取规范', '凭处方和缴费单到药房取药，核对药品信息，了解用药方法和注意事项。', '药品管理', 'active', 1),
(4, '检查注意事项', '空腹检查前8小时禁食，B超检查需憋尿，CT检查需去除金属物品。', '检查规范', 'active', 1),
(5, '医保报销流程', '持医保卡和身份证就诊，费用实时结算。特殊项目需提前审批。', '医保政策', 'active', 1),
(6, '住院办理流程', '医生开具住院证 → 住院处办理手续 → 缴纳押金 → 入住病房', '住院流程', 'active', 1),
(7, '转诊转院规范', '需经主治医生评估，填写转诊单，医务科审批，接收医院同意。', '转诊规范', 'active', 1);

-- ============================================
-- 诊室数据初始化脚本（72个诊室）
-- 每个父科室对应一栋楼，每栋楼有对应的子科室
-- 每个子科室2个诊室，共36个子科室，72个诊室
-- ============================================

USE hopital;

-- ============================================
-- 第一部分：清空现有数据（可选）
-- ============================================
-- 如果你想重新开始，可以取消注释下面的语句
/*
SET FOREIGN_KEY_CHECKS = 0;
TRUNCATE TABLE `locations`;
TRUNCATE TABLE `map_edges`;
TRUNCATE TABLE `map_nodes`;
SET FOREIGN_KEY_CHECKS = 1;
*/

-- ============================================
-- 第二部分：父科室与楼栋对应关系
-- ============================================
-- 1-内科楼，2-外科楼，3-儿科楼，4-妇产科楼

-- ============================================
-- 第三部分：创建地图节点（按楼栋和楼层）
-- ============================================

-- 内科楼（1号楼）- 10个子科室，20个诊室
-- 1楼：神经科、消化科
-- 2楼：呼吸科、心血管科
-- 3楼：内分泌科、肝病科
-- 4楼：肾内科、普通内科
-- 5楼：血液科、风湿免疫科

-- 外科楼（2号楼）- 11个子科室，22个诊室
-- 1楼：乳腺科、心外科
-- 2楼：普通外科、泌尿科
-- 3楼：神经脑外科、肛肠科
-- 4楼：肝胆科、肿瘤科
-- 5楼：胸外科、血管科
-- 6楼：男科

-- 儿科楼（3号楼）- 11个子科室，22个诊室
-- 1楼：儿科其他、内科
-- 2楼：外科、小儿口腔科
-- 3楼：新生儿科、眼科
-- 4楼：神经内科、精神心理
-- 5楼：耳鼻喉科、营养保健科
-- 6楼：骨科

-- 妇产科楼（4号楼）- 4个子科室，8个诊室
-- 1楼：产科
-- 2楼：妇产科
-- 3楼：生殖医学科
-- 4楼：计划生育

-- 创建诊室节点
INSERT INTO `map_nodes` (`node_name`, `node_type`, `coordinates_x`, `coordinates_y`, `floor_level`, `description`, `is_accessible`) VALUES
-- 内科楼（1号楼）诊室节点
-- 1楼：神经科、消化科
('内科楼101室入口', 'room', 15.0, 10.0, 1, '神经科诊室1入口节点', TRUE),
('内科楼102室入口', 'room', 25.0, 10.0, 1, '神经科诊室2入口节点', TRUE),
('内科楼103室入口', 'room', 15.0, 15.0, 1, '消化科诊室1入口节点', TRUE),
('内科楼104室入口', 'room', 25.0, 15.0, 1, '消化科诊室2入口节点', TRUE),
-- 2楼：呼吸科、心血管科
('内科楼201室入口', 'room', 15.0, 10.0, 2, '呼吸科诊室1入口节点', TRUE),
('内科楼202室入口', 'room', 25.0, 10.0, 2, '呼吸科诊室2入口节点', TRUE),
('内科楼203室入口', 'room', 15.0, 15.0, 2, '心血管科诊室1入口节点', TRUE),
('内科楼204室入口', 'room', 25.0, 15.0, 2, '心血管科诊室2入口节点', TRUE),
-- 3楼：内分泌科、肝病科
('内科楼301室入口', 'room', 15.0, 10.0, 3, '内分泌科诊室1入口节点', TRUE),
('内科楼302室入口', 'room', 25.0, 10.0, 3, '内分泌科诊室2入口节点', TRUE),
('内科楼303室入口', 'room', 15.0, 15.0, 3, '肝病科诊室1入口节点', TRUE),
('内科楼304室入口', 'room', 25.0, 15.0, 3, '肝病科诊室2入口节点', TRUE),
-- 4楼：肾内科、普通内科
('内科楼401室入口', 'room', 15.0, 10.0, 4, '肾内科诊室1入口节点', TRUE),
('内科楼402室入口', 'room', 25.0, 10.0, 4, '肾内科诊室2入口节点', TRUE),
('内科楼403室入口', 'room', 15.0, 15.0, 4, '普通内科诊室1入口节点', TRUE),
('内科楼404室入口', 'room', 25.0, 15.0, 4, '普通内科诊室2入口节点', TRUE),
-- 5楼：血液科、风湿免疫科
('内科楼501室入口', 'room', 15.0, 10.0, 5, '血液科诊室1入口节点', TRUE),
('内科楼502室入口', 'room', 25.0, 10.0, 5, '血液科诊室2入口节点', TRUE),
('内科楼503室入口', 'room', 15.0, 15.0, 5, '风湿免疫科诊室1入口节点', TRUE),
('内科楼504室入口', 'room', 25.0, 15.0, 5, '风湿免疫科诊室2入口节点', TRUE),

-- 外科楼（2号楼）诊室节点
-- 1楼：乳腺科、心外科
('外科楼101室入口', 'room', 15.0, 10.0, 1, '乳腺科诊室1入口节点', TRUE),
('外科楼102室入口', 'room', 25.0, 10.0, 1, '乳腺科诊室2入口节点', TRUE),
('外科楼103室入口', 'room', 15.0, 15.0, 1, '心外科诊室1入口节点', TRUE),
('外科楼104室入口', 'room', 25.0, 15.0, 1, '心外科诊室2入口节点', TRUE),
-- 2楼：普通外科、泌尿科
('外科楼201室入口', 'room', 15.0, 10.0, 2, '普通外科诊室1入口节点', TRUE),
('外科楼202室入口', 'room', 25.0, 10.0, 2, '普通外科诊室2入口节点', TRUE),
('外科楼203室入口', 'room', 15.0, 15.0, 2, '泌尿科诊室1入口节点', TRUE),
('外科楼204室入口', 'room', 25.0, 15.0, 2, '泌尿科诊室2入口节点', TRUE),
-- 3楼：神经脑外科、肛肠科
('外科楼301室入口', 'room', 15.0, 10.0, 3, '神经脑外科诊室1入口节点', TRUE),
('外科楼302室入口', 'room', 25.0, 10.0, 3, '神经脑外科诊室2入口节点', TRUE),
('外科楼303室入口', 'room', 15.0, 15.0, 3, '肛肠科诊室1入口节点', TRUE),
('外科楼304室入口', 'room', 25.0, 15.0, 3, '肛肠科诊室2入口节点', TRUE),
-- 4楼：肝胆科、肿瘤科
('外科楼401室入口', 'room', 15.0, 10.0, 4, '肝胆科诊室1入口节点', TRUE),
('外科楼402室入口', 'room', 25.0, 10.0, 4, '肝胆科诊室2入口节点', TRUE),
('外科楼403室入口', 'room', 15.0, 15.0, 4, '肿瘤科诊室1入口节点', TRUE),
('外科楼404室入口', 'room', 25.0, 15.0, 4, '肿瘤科诊室2入口节点', TRUE),
-- 5楼：胸外科、血管科
('外科楼501室入口', 'room', 15.0, 10.0, 5, '胸外科诊室1入口节点', TRUE),
('外科楼502室入口', 'room', 25.0, 10.0, 5, '胸外科诊室2入口节点', TRUE),
('外科楼503室入口', 'room', 15.0, 15.0, 5, '血管科诊室1入口节点', TRUE),
('外科楼504室入口', 'room', 25.0, 15.0, 5, '血管科诊室2入口节点', TRUE),
-- 6楼：男科
('外科楼601室入口', 'room', 20.0, 10.0, 6, '男科诊室1入口节点', TRUE),
('外科楼602室入口', 'room', 20.0, 15.0, 6, '男科诊室2入口节点', TRUE),

-- 儿科楼（3号楼）诊室节点
-- 1楼：儿科其他、内科
('儿科楼101室入口', 'room', 15.0, 10.0, 1, '儿科其他诊室1入口节点', TRUE),
('儿科楼102室入口', 'room', 25.0, 10.0, 1, '儿科其他诊室2入口节点', TRUE),
('儿科楼103室入口', 'room', 15.0, 15.0, 1, '儿科内科诊室1入口节点', TRUE),
('儿科楼104室入口', 'room', 25.0, 15.0, 1, '儿科内科诊室2入口节点', TRUE),
-- 2楼：外科、小儿口腔科
('儿科楼201室入口', 'room', 15.0, 10.0, 2, '儿科外科诊室1入口节点', TRUE),
('儿科楼202室入口', 'room', 25.0, 10.0, 2, '儿科外科诊室2入口节点', TRUE),
('儿科楼203室入口', 'room', 15.0, 15.0, 2, '小儿口腔科诊室1入口节点', TRUE),
('儿科楼204室入口', 'room', 25.0, 15.0, 2, '小儿口腔科诊室2入口节点', TRUE),
-- 3楼：新生儿科、眼科
('儿科楼301室入口', 'room', 15.0, 10.0, 3, '新生儿科诊室1入口节点', TRUE),
('儿科楼302室入口', 'room', 25.0, 10.0, 3, '新生儿科诊室2入口节点', TRUE),
('儿科楼303室入口', 'room', 15.0, 15.0, 3, '眼科诊室1入口节点', TRUE),
('儿科楼304室入口', 'room', 25.0, 15.0, 3, '眼科诊室2入口节点', TRUE),
-- 4楼：神经内科、精神心理
('儿科楼401室入口', 'room', 15.0, 10.0, 4, '神经内科诊室1入口节点', TRUE),
('儿科楼402室入口', 'room', 25.0, 10.0, 4, '神经内科诊室2入口节点', TRUE),
('儿科楼403室入口', 'room', 15.0, 15.0, 4, '精神心理诊室1入口节点', TRUE),
('儿科楼404室入口', 'room', 25.0, 15.0, 4, '精神心理诊室2入口节点', TRUE),
-- 5楼：耳鼻喉科、营养保健科
('儿科楼501室入口', 'room', 15.0, 10.0, 5, '耳鼻喉科诊室1入口节点', TRUE),
('儿科楼502室入口', 'room', 25.0, 10.0, 5, '耳鼻喉科诊室2入口节点', TRUE),
('儿科楼503室入口', 'room', 15.0, 15.0, 5, '营养保健科诊室1入口节点', TRUE),
('儿科楼504室入口', 'room', 25.0, 15.0, 5, '营养保健科诊室2入口节点', TRUE),
-- 6楼：骨科
('儿科楼601室入口', 'room', 20.0, 10.0, 6, '骨科诊室1入口节点', TRUE),
('儿科楼602室入口', 'room', 20.0, 15.0, 6, '骨科诊室2入口节点', TRUE),

-- 妇产科楼（4号楼）诊室节点
-- 1楼：产科
('妇产科楼101室入口', 'room', 20.0, 10.0, 1, '产科诊室1入口节点', TRUE),
('妇产科楼102室入口', 'room', 20.0, 15.0, 1, '产科诊室2入口节点', TRUE),
-- 2楼：妇产科
('妇产科楼201室入口', 'room', 20.0, 10.0, 2, '妇产科诊室1入口节点', TRUE),
('妇产科楼202室入口', 'room', 20.0, 15.0, 2, '妇产科诊室2入口节点', TRUE),
-- 3楼：生殖医学科
('妇产科楼301室入口', 'room', 20.0, 10.0, 3, '生殖医学科诊室1入口节点', TRUE),
('妇产科楼302室入口', 'room', 20.0, 15.0, 3, '生殖医学科诊室2入口节点', TRUE),
-- 4楼：计划生育
('妇产科楼401室入口', 'room', 20.0, 10.0, 4, '计划生育诊室1入口节点', TRUE),
('妇产科楼402室入口', 'room', 20.0, 15.0, 4, '计划生育诊室2入口节点', TRUE);

-- ============================================
-- 第四部分：创建诊室地点记录
-- ============================================

-- 获取科室ID与楼栋对应关系
-- 科室ID：1-36，对应前面插入的顺序
-- 1-10: 内科楼，11-21: 外科楼，22-32: 儿科楼，33-36: 妇产科楼

-- 为每个科室创建2个诊室
-- ============================================
-- 修复 locations 表插入问题
-- 1. 解决子查询返回多行错误（Error 1242）
-- 2. 修复重复数据问题
-- 3. 删除已插入的重复数据
-- ============================================

-- 第一步：删除重复的 location_name 数据（保留最早的记录）
-- 查找重复的 location_name
SELECT 
    location_name,
    COUNT(*) as count,
    GROUP_CONCAT(location_id ORDER BY location_id) as location_ids
FROM locations
GROUP BY location_name
HAVING COUNT(*) > 1;

-- 删除重复记录（保留每个 location_name 的最小 location_id）
-- DELETE l1 FROM locations l1
-- INNER JOIN locations l2 
-- WHERE l1.location_name = l2.location_name 
--  AND l1.location_id > l2.location_id;

-- 第二步：修复后的 INSERT 语句
-- 主要修复：
-- 1. 子查询添加 LIMIT 1 确保只返回一行
-- 2. 优化 WHERE 条件，确保每个科室-房间组合只匹配一次
-- 3. 使用更精确的 JOIN 条件

INSERT INTO `locations` (`location_name`, `department_id`, `floor_level`, `building`, `room_number`, `capacity`, `map_node_id`)
SELECT 
    -- 诊室名称：楼栋名 + 房间号
    CONCAT(
        CASE 
            WHEN d.department_id BETWEEN 1 AND 10 THEN '内科楼'
            WHEN d.department_id BETWEEN 11 AND 21 THEN '外科楼'
            WHEN d.department_id BETWEEN 22 AND 32 THEN '儿科楼'
            WHEN d.department_id BETWEEN 33 AND 36 THEN '妇产科楼'
            ELSE '综合楼'
        END,
        room_num
    ) AS location_name,
    d.department_id AS department_id,
    -- 楼层分配：每个科室在对应楼栋的特定楼层
    CASE 
        -- 内科楼 (1-10科室)
        WHEN d.department_id = 1 THEN 1  -- 神经科 1楼
        WHEN d.department_id = 2 THEN 1  -- 消化科 1楼
        WHEN d.department_id = 3 THEN 2  -- 呼吸科 2楼
        WHEN d.department_id = 4 THEN 2  -- 心血管科 2楼
        WHEN d.department_id = 5 THEN 3  -- 内分泌科 3楼
        WHEN d.department_id = 6 THEN 3  -- 肝病科 3楼
        WHEN d.department_id = 7 THEN 4  -- 肾内科 4楼
        WHEN d.department_id = 8 THEN 4  -- 普通内科 4楼
        WHEN d.department_id = 9 THEN 5  -- 血液科 5楼
        WHEN d.department_id = 10 THEN 5 -- 风湿免疫科 5楼
        
        -- 外科楼 (11-21科室)
        WHEN d.department_id = 11 THEN 1  -- 乳腺科 1楼
        WHEN d.department_id = 12 THEN 1  -- 心外科 1楼
        WHEN d.department_id = 13 THEN 2  -- 普通外科 2楼
        WHEN d.department_id = 14 THEN 2  -- 泌尿科 2楼
        WHEN d.department_id = 15 THEN 3  -- 神经脑外科 3楼
        WHEN d.department_id = 16 THEN 3  -- 肛肠科 3楼
        WHEN d.department_id = 17 THEN 4  -- 肝胆科 4楼
        WHEN d.department_id = 18 THEN 4  -- 肿瘤科 4楼
        WHEN d.department_id = 19 THEN 5  -- 胸外科 5楼
        WHEN d.department_id = 20 THEN 5  -- 血管科 5楼
        WHEN d.department_id = 21 THEN 6  -- 男科 6楼
        
        -- 儿科楼 (22-32科室)
        WHEN d.department_id = 22 THEN 1  -- 儿科其他 1楼
        WHEN d.department_id = 23 THEN 1  -- 内科 1楼
        WHEN d.department_id = 24 THEN 2  -- 外科 2楼
        WHEN d.department_id = 25 THEN 2  -- 小儿口腔科 2楼
        WHEN d.department_id = 26 THEN 3  -- 新生儿科 3楼
        WHEN d.department_id = 27 THEN 3  -- 眼科 3楼
        WHEN d.department_id = 28 THEN 4  -- 神经内科 4楼
        WHEN d.department_id = 29 THEN 4  -- 精神心理 4楼
        WHEN d.department_id = 30 THEN 5  -- 耳鼻喉科 5楼
        WHEN d.department_id = 31 THEN 5  -- 营养保健科 5楼
        WHEN d.department_id = 32 THEN 6  -- 骨科 6楼
        
        -- 妇产科楼 (33-36科室)
        WHEN d.department_id = 33 THEN 1  -- 产科 1楼
        WHEN d.department_id = 34 THEN 2  -- 妇产科 2楼
        WHEN d.department_id = 35 THEN 3  -- 生殖医学科 3楼
        WHEN d.department_id = 36 THEN 4  -- 计划生育 4楼
        ELSE 1
    END AS floor_level,
    -- 楼栋名
    CASE 
        WHEN d.department_id BETWEEN 1 AND 10 THEN '内科楼'
        WHEN d.department_id BETWEEN 11 AND 21 THEN '外科楼'
        WHEN d.department_id BETWEEN 22 AND 32 THEN '儿科楼'
        WHEN d.department_id BETWEEN 33 AND 36 THEN '妇产科楼'
        ELSE '综合楼'
    END AS building,
    -- 房间号：楼层+2位数编号
    CASE 
        -- 内科楼
        WHEN d.department_id = 1 AND room_num = '101室' THEN '1-01'
        WHEN d.department_id = 1 AND room_num = '102室' THEN '1-02'
        WHEN d.department_id = 2 AND room_num = '103室' THEN '1-03'
        WHEN d.department_id = 2 AND room_num = '104室' THEN '1-04'
        WHEN d.department_id = 3 AND room_num = '201室' THEN '2-01'
        WHEN d.department_id = 3 AND room_num = '202室' THEN '2-02'
        WHEN d.department_id = 4 AND room_num = '203室' THEN '2-03'
        WHEN d.department_id = 4 AND room_num = '204室' THEN '2-04'
        WHEN d.department_id = 5 AND room_num = '301室' THEN '3-01'
        WHEN d.department_id = 5 AND room_num = '302室' THEN '3-02'
        WHEN d.department_id = 6 AND room_num = '303室' THEN '3-03'
        WHEN d.department_id = 6 AND room_num = '304室' THEN '3-04'
        WHEN d.department_id = 7 AND room_num = '401室' THEN '4-01'
        WHEN d.department_id = 7 AND room_num = '402室' THEN '4-02'
        WHEN d.department_id = 8 AND room_num = '403室' THEN '4-03'
        WHEN d.department_id = 8 AND room_num = '404室' THEN '4-04'
        WHEN d.department_id = 9 AND room_num = '501室' THEN '5-01'
        WHEN d.department_id = 9 AND room_num = '502室' THEN '5-02'
        WHEN d.department_id = 10 AND room_num = '503室' THEN '5-03'
        WHEN d.department_id = 10 AND room_num = '504室' THEN '5-04'
        
        -- 外科楼
        WHEN d.department_id = 11 AND room_num = '101室' THEN '1-01'
        WHEN d.department_id = 11 AND room_num = '102室' THEN '1-02'
        WHEN d.department_id = 12 AND room_num = '103室' THEN '1-03'
        WHEN d.department_id = 12 AND room_num = '104室' THEN '1-04'
        WHEN d.department_id = 13 AND room_num = '201室' THEN '2-01'
        WHEN d.department_id = 13 AND room_num = '202室' THEN '2-02'
        WHEN d.department_id = 14 AND room_num = '203室' THEN '2-03'
        WHEN d.department_id = 14 AND room_num = '204室' THEN '2-04'
        WHEN d.department_id = 15 AND room_num = '301室' THEN '3-01'
        WHEN d.department_id = 15 AND room_num = '302室' THEN '3-02'
        WHEN d.department_id = 16 AND room_num = '303室' THEN '3-03'
        WHEN d.department_id = 16 AND room_num = '304室' THEN '3-04'
        WHEN d.department_id = 17 AND room_num = '401室' THEN '4-01'
        WHEN d.department_id = 17 AND room_num = '402室' THEN '4-02'
        WHEN d.department_id = 18 AND room_num = '403室' THEN '4-03'
        WHEN d.department_id = 18 AND room_num = '404室' THEN '4-04'
        WHEN d.department_id = 19 AND room_num = '501室' THEN '5-01'
        WHEN d.department_id = 19 AND room_num = '502室' THEN '5-02'
        WHEN d.department_id = 20 AND room_num = '503室' THEN '5-03'
        WHEN d.department_id = 20 AND room_num = '504室' THEN '5-04'
        WHEN d.department_id = 21 AND room_num = '601室' THEN '6-01'
        WHEN d.department_id = 21 AND room_num = '602室' THEN '6-02'
        
        -- 儿科楼
        WHEN d.department_id = 22 AND room_num = '101室' THEN '1-01'
        WHEN d.department_id = 22 AND room_num = '102室' THEN '1-02'
        WHEN d.department_id = 23 AND room_num = '103室' THEN '1-03'
        WHEN d.department_id = 23 AND room_num = '104室' THEN '1-04'
        WHEN d.department_id = 24 AND room_num = '201室' THEN '2-01'
        WHEN d.department_id = 24 AND room_num = '202室' THEN '2-02'
        WHEN d.department_id = 25 AND room_num = '203室' THEN '2-03'
        WHEN d.department_id = 25 AND room_num = '204室' THEN '2-04'
        WHEN d.department_id = 26 AND room_num = '301室' THEN '3-01'
        WHEN d.department_id = 26 AND room_num = '302室' THEN '3-02'
        WHEN d.department_id = 27 AND room_num = '303室' THEN '3-03'
        WHEN d.department_id = 27 AND room_num = '304室' THEN '3-04'
        WHEN d.department_id = 28 AND room_num = '401室' THEN '4-01'
        WHEN d.department_id = 28 AND room_num = '402室' THEN '4-02'
        WHEN d.department_id = 29 AND room_num = '403室' THEN '4-03'
        WHEN d.department_id = 29 AND room_num = '404室' THEN '4-04'
        WHEN d.department_id = 30 AND room_num = '501室' THEN '5-01'
        WHEN d.department_id = 30 AND room_num = '502室' THEN '5-02'
        WHEN d.department_id = 31 AND room_num = '503室' THEN '5-03'
        WHEN d.department_id = 31 AND room_num = '504室' THEN '5-04'
        WHEN d.department_id = 32 AND room_num = '601室' THEN '6-01'
        WHEN d.department_id = 32 AND room_num = '602室' THEN '6-02'
        
        -- 妇产科楼
        WHEN d.department_id = 33 AND room_num = '101室' THEN '1-01'
        WHEN d.department_id = 33 AND room_num = '102室' THEN '1-02'
        WHEN d.department_id = 34 AND room_num = '201室' THEN '2-01'
        WHEN d.department_id = 34 AND room_num = '202室' THEN '2-02'
        WHEN d.department_id = 35 AND room_num = '301室' THEN '3-01'
        WHEN d.department_id = 35 AND room_num = '302室' THEN '3-02'
        WHEN d.department_id = 36 AND room_num = '401室' THEN '4-01'
        WHEN d.department_id = 36 AND room_num = '402室' THEN '4-02'
        
        -- 默认情况：使用楼层+房间号后4位
        ELSE CONCAT(
            CASE 
                -- 内科楼楼层
                WHEN d.department_id = 1 THEN '1'
                WHEN d.department_id = 2 THEN '1'
                WHEN d.department_id = 3 THEN '2'
                WHEN d.department_id = 4 THEN '2'
                WHEN d.department_id = 5 THEN '3'
                WHEN d.department_id = 6 THEN '3'
                WHEN d.department_id = 7 THEN '4'
                WHEN d.department_id = 8 THEN '4'
                WHEN d.department_id = 9 THEN '5'
                WHEN d.department_id = 10 THEN '5'
                -- 外科楼楼层
                WHEN d.department_id = 11 THEN '1'
                WHEN d.department_id = 12 THEN '1'
                WHEN d.department_id = 13 THEN '2'
                WHEN d.department_id = 14 THEN '2'
                WHEN d.department_id = 15 THEN '3'
                WHEN d.department_id = 16 THEN '3'
                WHEN d.department_id = 17 THEN '4'
                WHEN d.department_id = 18 THEN '4'
                WHEN d.department_id = 19 THEN '5'
                WHEN d.department_id = 20 THEN '5'
                WHEN d.department_id = 21 THEN '6'
                -- 儿科楼楼层
                WHEN d.department_id = 22 THEN '1'
                WHEN d.department_id = 23 THEN '1'
                WHEN d.department_id = 24 THEN '2'
                WHEN d.department_id = 25 THEN '2'
                WHEN d.department_id = 26 THEN '3'
                WHEN d.department_id = 27 THEN '3'
                WHEN d.department_id = 28 THEN '4'
                WHEN d.department_id = 29 THEN '4'
                WHEN d.department_id = 30 THEN '5'
                WHEN d.department_id = 31 THEN '5'
                WHEN d.department_id = 32 THEN '6'
                -- 妇产科楼楼层
                WHEN d.department_id = 33 THEN '1'
                WHEN d.department_id = 34 THEN '2'
                WHEN d.department_id = 35 THEN '3'
                WHEN d.department_id = 36 THEN '4'
                ELSE '1'
            END, 
            '-', 
            RIGHT(room_num, 4)
        )
    END AS room_number,
    5 AS capacity,  -- 每个诊室容纳5人
    -- 修复：子查询添加 LIMIT 1 确保只返回一行，避免 Error 1242
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT(
        CASE 
            WHEN d.department_id BETWEEN 1 AND 10 THEN '内科楼'
            WHEN d.department_id BETWEEN 11 AND 21 THEN '外科楼'
            WHEN d.department_id BETWEEN 22 AND 32 THEN '儿科楼'
            WHEN d.department_id BETWEEN 33 AND 36 THEN '妇产科楼'
            ELSE '综合楼'
        END,
        room_num,
        '入口'
     ) 
     AND floor_level = CASE 
        -- 内科楼楼层
        WHEN d.department_id = 1 THEN 1
        WHEN d.department_id = 2 THEN 1
        WHEN d.department_id = 3 THEN 2
        WHEN d.department_id = 4 THEN 2
        WHEN d.department_id = 5 THEN 3
        WHEN d.department_id = 6 THEN 3
        WHEN d.department_id = 7 THEN 4
        WHEN d.department_id = 8 THEN 4
        WHEN d.department_id = 9 THEN 5
        WHEN d.department_id = 10 THEN 5
        -- 外科楼楼层
        WHEN d.department_id = 11 THEN 1
        WHEN d.department_id = 12 THEN 1
        WHEN d.department_id = 13 THEN 2
        WHEN d.department_id = 14 THEN 2
        WHEN d.department_id = 15 THEN 3
        WHEN d.department_id = 16 THEN 3
        WHEN d.department_id = 17 THEN 4
        WHEN d.department_id = 18 THEN 4
        WHEN d.department_id = 19 THEN 5
        WHEN d.department_id = 20 THEN 5
        WHEN d.department_id = 21 THEN 6
        -- 儿科楼楼层
        WHEN d.department_id = 22 THEN 1
        WHEN d.department_id = 23 THEN 1
        WHEN d.department_id = 24 THEN 2
        WHEN d.department_id = 25 THEN 2
        WHEN d.department_id = 26 THEN 3
        WHEN d.department_id = 27 THEN 3
        WHEN d.department_id = 28 THEN 4
        WHEN d.department_id = 29 THEN 4
        WHEN d.department_id = 30 THEN 5
        WHEN d.department_id = 31 THEN 5
        WHEN d.department_id = 32 THEN 6
        -- 妇产科楼楼层
        WHEN d.department_id = 33 THEN 1
        WHEN d.department_id = 34 THEN 2
        WHEN d.department_id = 35 THEN 3
        WHEN d.department_id = 36 THEN 4
        ELSE 1
     END
     LIMIT 1  -- 关键修复：确保只返回一行
    ) AS map_node_id
FROM `departments` d
-- 为每个科室生成对应的诊室
CROSS JOIN (
    SELECT '101室' AS room_num UNION SELECT '102室' UNION 
    SELECT '103室' UNION SELECT '104室' UNION
    SELECT '201室' UNION SELECT '202室' UNION
    SELECT '203室' UNION SELECT '204室' UNION
    SELECT '301室' UNION SELECT '302室' UNION
    SELECT '303室' UNION SELECT '304室' UNION
    SELECT '401室' UNION SELECT '402室' UNION
    SELECT '403室' UNION SELECT '404室' UNION
    SELECT '501室' UNION SELECT '502室' UNION
    SELECT '503室' UNION SELECT '504室' UNION
    SELECT '601室' UNION SELECT '602室'
) AS room_nums
WHERE d.department_id BETWEEN 1 AND 36
  -- 修复：使用更精确的匹配条件，确保每个科室-房间组合只匹配一次
  AND (
    -- 内科楼：1-10科室
    (d.department_id = 1 AND room_nums.room_num IN ('101室','102室')) OR
    (d.department_id = 2 AND room_nums.room_num IN ('103室','104室')) OR
    (d.department_id = 3 AND room_nums.room_num IN ('201室','202室')) OR
    (d.department_id = 4 AND room_nums.room_num IN ('203室','204室')) OR
    (d.department_id = 5 AND room_nums.room_num IN ('301室','302室')) OR
    (d.department_id = 6 AND room_nums.room_num IN ('303室','304室')) OR
    (d.department_id = 7 AND room_nums.room_num IN ('401室','402室')) OR
    (d.department_id = 8 AND room_nums.room_num IN ('403室','404室')) OR
    (d.department_id = 9 AND room_nums.room_num IN ('501室','502室')) OR
    (d.department_id = 10 AND room_nums.room_num IN ('503室','504室')) OR
  
    -- 外科楼：11-21科室
    (d.department_id = 11 AND room_nums.room_num IN ('101室','102室')) OR
    (d.department_id = 12 AND room_nums.room_num IN ('103室','104室')) OR
    (d.department_id = 13 AND room_nums.room_num IN ('201室','202室')) OR
    (d.department_id = 14 AND room_nums.room_num IN ('203室','204室')) OR
    (d.department_id = 15 AND room_nums.room_num IN ('301室','302室')) OR
    (d.department_id = 16 AND room_nums.room_num IN ('303室','304室')) OR
    (d.department_id = 17 AND room_nums.room_num IN ('401室','402室')) OR
    (d.department_id = 18 AND room_nums.room_num IN ('403室','404室')) OR
    (d.department_id = 19 AND room_nums.room_num IN ('501室','502室')) OR
    (d.department_id = 20 AND room_nums.room_num IN ('503室','504室')) OR
    (d.department_id = 21 AND room_nums.room_num IN ('601室','602室')) OR
  
    -- 儿科楼：22-32科室
    (d.department_id = 22 AND room_nums.room_num IN ('101室','102室')) OR
    (d.department_id = 23 AND room_nums.room_num IN ('103室','104室')) OR
    (d.department_id = 24 AND room_nums.room_num IN ('201室','202室')) OR
    (d.department_id = 25 AND room_nums.room_num IN ('203室','204室')) OR
    (d.department_id = 26 AND room_nums.room_num IN ('301室','302室')) OR
    (d.department_id = 27 AND room_nums.room_num IN ('303室','304室')) OR
    (d.department_id = 28 AND room_nums.room_num IN ('401室','402室')) OR
    (d.department_id = 29 AND room_nums.room_num IN ('403室','404室')) OR
    (d.department_id = 30 AND room_nums.room_num IN ('501室','502室')) OR
    (d.department_id = 31 AND room_nums.room_num IN ('503室','504室')) OR
    (d.department_id = 32 AND room_nums.room_num IN ('601室','602室')) OR
  
    -- 妇产科楼：33-36科室
    (d.department_id = 33 AND room_nums.room_num IN ('101室','102室')) OR
    (d.department_id = 34 AND room_nums.room_num IN ('201室','202室')) OR
    (d.department_id = 35 AND room_nums.room_num IN ('301室','302室')) OR
    (d.department_id = 36 AND room_nums.room_num IN ('401室','402室'))
  )
  -- 避免插入已存在的 location_name
  AND NOT EXISTS (
    SELECT 1 FROM locations l 
    WHERE l.location_name = CONCAT(
        CASE 
            WHEN d.department_id BETWEEN 1 AND 10 THEN '内科楼'
            WHEN d.department_id BETWEEN 11 AND 21 THEN '外科楼'
            WHEN d.department_id BETWEEN 22 AND 32 THEN '儿科楼'
            WHEN d.department_id BETWEEN 33 AND 36 THEN '妇产科楼'
            ELSE '综合楼'
        END,
        room_nums.room_num
    )
  )
ORDER BY d.department_id, room_nums.room_num;

-- ============================================
-- 第五部分：创建公共节点和路径连接
-- ============================================

-- 创建各楼栋的公共节点（大厅、走廊、电梯、楼梯等）
INSERT INTO `map_nodes` (`node_name`, `node_type`, `coordinates_x`, `coordinates_y`, `floor_level`, `description`, `is_accessible`)
SELECT * FROM (
    -- 内科楼公共节点
    SELECT '内科楼大门' AS node_name, 'entrance' AS node_type, 20.0 AS coordinates_x, 40.0 AS coordinates_y, 1 AS floor_level, '内科楼主要出入口' AS description, TRUE AS is_accessible UNION
    SELECT '内科楼大厅', 'hallway', 20.0, 38.0, 1, '内科楼大厅', TRUE UNION
    SELECT '内科楼分诊台', 'hallway', 20.0, 36.0, 1, '内科楼分诊台', TRUE UNION
    SELECT '内科楼1楼主走廊', 'hallway', 20.0, 34.0, 1, '内科楼1楼主走廊', TRUE UNION
    SELECT '内科楼2楼主走廊', 'hallway', 20.0, 34.0, 2, '内科楼2楼主走廊', TRUE UNION
    SELECT '内科楼3楼主走廊', 'hallway', 20.0, 34.0, 3, '内科楼3楼主走廊', TRUE UNION
    SELECT '内科楼4楼主走廊', 'hallway', 20.0, 34.0, 4, '内科楼4楼主走廊', TRUE UNION
    SELECT '内科楼5楼主走廊', 'hallway', 20.0, 34.0, 5, '内科楼5楼主走廊', TRUE UNION
    SELECT '内科楼1号电梯-1楼', 'elevator', 35.0, 36.0, 1, '内科楼1号电梯1楼', TRUE UNION
    SELECT '内科楼1号电梯-2楼', 'elevator', 35.0, 36.0, 2, '内科楼1号电梯2楼', TRUE UNION
    SELECT '内科楼1号电梯-3楼', 'elevator', 35.0, 36.0, 3, '内科楼1号电梯3楼', TRUE UNION
    SELECT '内科楼1号电梯-4楼', 'elevator', 35.0, 36.0, 4, '内科楼1号电梯4楼', TRUE UNION
    SELECT '内科楼1号电梯-5楼', 'elevator', 35.0, 36.0, 5, '内科楼1号电梯5楼', TRUE UNION
    SELECT '内科楼1号楼梯-1楼', 'stairs', 5.0, 36.0, 1, '内科楼1号楼梯1楼', TRUE UNION
    SELECT '内科楼1号楼梯-2楼', 'stairs', 5.0, 36.0, 2, '内科楼1号楼梯2楼', TRUE UNION
    SELECT '内科楼1号楼梯-3楼', 'stairs', 5.0, 36.0, 3, '内科楼1号楼梯3楼', TRUE UNION
    SELECT '内科楼1号楼梯-4楼', 'stairs', 5.0, 36.0, 4, '内科楼1号楼梯4楼', TRUE UNION
    SELECT '内科楼1号楼梯-5楼', 'stairs', 5.0, 36.0, 5, '内科楼1号楼梯5楼', TRUE
    
    -- 外科楼公共节点
    UNION SELECT '外科楼大门', 'entrance', 20.0, 40.0, 1, '外科楼主要出入口', TRUE UNION
    SELECT '外科楼大厅', 'hallway', 20.0, 38.0, 1, '外科楼大厅', TRUE UNION
    SELECT '外科楼分诊台', 'hallway', 20.0, 36.0, 1, '外科楼分诊台', TRUE UNION
    SELECT '外科楼1楼主走廊', 'hallway', 20.0, 34.0, 1, '外科楼1楼主走廊', TRUE UNION
    SELECT '外科楼2楼主走廊', 'hallway', 20.0, 34.0, 2, '外科楼2楼主走廊', TRUE UNION
    SELECT '外科楼3楼主走廊', 'hallway', 20.0, 34.0, 3, '外科楼3楼主走廊', TRUE UNION
    SELECT '外科楼4楼主走廊', 'hallway', 20.0, 34.0, 4, '外科楼4楼主走廊', TRUE UNION
    SELECT '外科楼5楼主走廊', 'hallway', 20.0, 34.0, 5, '外科楼5楼主走廊', TRUE UNION
    SELECT '外科楼6楼主走廊', 'hallway', 20.0, 34.0, 6, '外科楼6楼主走廊', TRUE UNION
    SELECT '外科楼1号电梯-1楼', 'elevator', 35.0, 36.0, 1, '外科楼1号电梯1楼', TRUE UNION
    SELECT '外科楼1号电梯-2楼', 'elevator', 35.0, 36.0, 2, '外科楼1号电梯2楼', TRUE UNION
    SELECT '外科楼1号电梯-3楼', 'elevator', 35.0, 36.0, 3, '外科楼1号电梯3楼', TRUE UNION
    SELECT '外科楼1号电梯-4楼', 'elevator', 35.0, 36.0, 4, '外科楼1号电梯4楼', TRUE UNION
    SELECT '外科楼1号电梯-5楼', 'elevator', 35.0, 36.0, 5, '外科楼1号电梯5楼', TRUE UNION
    SELECT '外科楼1号电梯-6楼', 'elevator', 35.0, 36.0, 6, '外科楼1号电梯6楼', TRUE
    
    -- 儿科楼公共节点
    UNION SELECT '儿科楼大门', 'entrance', 20.0, 40.0, 1, '儿科楼主要出入口', TRUE UNION
    SELECT '儿科楼大厅', 'hallway', 20.0, 38.0, 1, '儿科楼大厅', TRUE UNION
    SELECT '儿科楼分诊台', 'hallway', 20.0, 36.0, 1, '儿科楼分诊台', TRUE UNION
    SELECT '儿科楼1楼主走廊', 'hallway', 20.0, 34.0, 1, '儿科楼1楼主走廊', TRUE UNION
    SELECT '儿科楼2楼主走廊', 'hallway', 20.0, 34.0, 2, '儿科楼2楼主走廊', TRUE UNION
    SELECT '儿科楼3楼主走廊', 'hallway', 20.0, 34.0, 3, '儿科楼3楼主走廊', TRUE UNION
    SELECT '儿科楼4楼主走廊', 'hallway', 20.0, 34.0, 4, '儿科楼4楼主走廊', TRUE UNION
    SELECT '儿科楼5楼主走廊', 'hallway', 20.0, 34.0, 5, '儿科楼5楼主走廊', TRUE UNION
    SELECT '儿科楼6楼主走廊', 'hallway', 20.0, 34.0, 6, '儿科楼6楼主走廊', TRUE
    
    -- 妇产科楼公共节点
    UNION SELECT '妇产科楼大门', 'entrance', 20.0, 40.0, 1, '妇产科楼主要出入口', TRUE UNION
    SELECT '妇产科楼大厅', 'hallway', 20.0, 38.0, 1, '妇产科楼大厅', TRUE UNION
    SELECT '妇产科楼分诊台', 'hallway', 20.0, 36.0, 1, '妇产科楼分诊台', TRUE UNION
    SELECT '妇产科楼1楼主走廊', 'hallway', 20.0, 34.0, 1, '妇产科楼1楼主走廊', TRUE UNION
    SELECT '妇产科楼2楼主走廊', 'hallway', 20.0, 34.0, 2, '妇产科楼2楼主走廊', TRUE UNION
    SELECT '妇产科楼3楼主走廊', 'hallway', 20.0, 34.0, 3, '妇产科楼3楼主走廊', TRUE UNION
    SELECT '妇产科楼4楼主走廊', 'hallway', 20.0, 34.0, 4, '妇产科楼4楼主走廊', TRUE
    
    -- 主医院公共节点（连接各楼栋）
    UNION SELECT '医院正门', 'entrance', 50.0, 50.0, 1, '医院主出入口', TRUE UNION
    SELECT '中心广场', 'hallway', 50.0, 45.0, 1, '医院中心广场，连接各楼栋', TRUE UNION
    SELECT '内科楼路口', 'hallway', 40.0, 45.0, 1, '通往内科楼的路口', TRUE UNION
    SELECT '外科楼路口', 'hallway', 60.0, 45.0, 1, '通往内科楼的路口', TRUE UNION
        SELECT '儿科楼路口', 'hallway', 40.0, 40.0, 1, '通往儿科楼的路口', TRUE UNION
    SELECT '妇产科楼路口', 'hallway', 60.0, 40.0, 1, '通往妇产科楼的路口', TRUE
) AS temp
WHERE NOT EXISTS (SELECT 1 FROM map_nodes WHERE node_name = temp.node_name AND floor_level = temp.floor_level);

-- ============================================
-- 第六部分：创建路径连接关系
-- ============================================

-- 1. 连接诊室到主走廊（各楼栋内部）
-- 内科楼诊室连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id AS start_node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('内科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level) AS end_node_id,
    8.0 AS distance,
    10 AS walk_time,
    TRUE AS is_bidirectional,
    '诊室到走廊连接' AS accessibility_info
FROM map_nodes n
WHERE n.node_type = 'room'
  AND n.node_name LIKE '内科楼%入口'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('内科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- 外科楼诊室连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id AS start_node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('外科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level) AS end_node_id,
    8.0 AS distance,
    10 AS walk_time,
    TRUE AS is_bidirectional,
    '诊室到走廊连接' AS accessibility_info
FROM map_nodes n
WHERE n.node_type = 'room'
  AND n.node_name LIKE '外科楼%入口'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('外科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- 儿科楼诊室连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id AS start_node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('儿科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level) AS end_node_id,
    8.0 AS distance,
    10 AS walk_time,
    TRUE AS is_bidirectional,
    '诊室到走廊连接' AS accessibility_info
FROM map_nodes n
WHERE n.node_type = 'room'
  AND n.node_name LIKE '儿科楼%入口'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('儿科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- 妇产科楼诊室连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id AS start_node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('妇产科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level) AS end_node_id,
    8.0 AS distance,
    10 AS walk_time,
    TRUE AS is_bidirectional,
    '诊室到走廊连接' AS accessibility_info
FROM map_nodes n
WHERE n.node_type = 'room'
  AND n.node_name LIKE '妇产科楼%入口'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('妇产科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- 2. 连接各楼栋内部楼层（电梯连接）
-- 内科楼电梯连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n1.node_id,
    n2.node_id,
    0.0, 30, TRUE, '电梯跨层连接'
FROM map_nodes n1
JOIN map_nodes n2 ON n2.node_name = REPLACE(n1.node_name, CONCAT('-', n1.floor_level, '楼'), CONCAT('-', n1.floor_level+1, '楼'))
WHERE n1.node_name LIKE '内科楼1号电梯%'
  AND n1.floor_level BETWEEN 1 AND 4
  AND n2.node_id IS NOT NULL;

-- 外科楼电梯连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n1.node_id,
    n2.node_id,
    0.0, 30, TRUE, '电梯跨层连接'
FROM map_nodes n1
JOIN map_nodes n2 ON n2.node_name = REPLACE(n1.node_name, CONCAT('-', n1.floor_level, '楼'), CONCAT('-', n1.floor_level+1, '楼'))
WHERE n1.node_name LIKE '外科楼1号电梯%'
  AND n1.floor_level BETWEEN 1 AND 5
  AND n2.node_id IS NOT NULL;

-- 3. 连接楼梯楼层（内科楼楼梯）
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n1.node_id,
    n2.node_id,
    0.0, 45, TRUE, '楼梯跨层连接'
FROM map_nodes n1
JOIN map_nodes n2 ON n2.node_name = REPLACE(n1.node_name, CONCAT('-', n1.floor_level, '楼'), CONCAT('-', n1.floor_level+1, '楼'))
WHERE n1.node_name LIKE '内科楼1号楼梯%'
  AND n1.floor_level BETWEEN 1 AND 4
  AND n2.node_id IS NOT NULL;

-- 4. 连接各楼栋内部：大门->大厅->分诊台->主走廊
-- 内科楼内部连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼大门' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼大厅' AND floor_level = 1),
    2.0, 3, TRUE, '大门到大厅'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼大门' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼大厅' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼大厅' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼分诊台' AND floor_level = 1),
    2.0, 3, TRUE, '大厅到分诊台'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼大厅' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼分诊台' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼分诊台' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼1楼主走廊' AND floor_level = 1),
    3.0, 4, TRUE, '分诊台到主走廊'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼分诊台' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼1楼主走廊' AND floor_level = 1);

-- 外科楼内部连接（类似内科楼）
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼大门' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼大厅' AND floor_level = 1),
    2.0, 3, TRUE, '大门到大厅'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼大门' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼大厅' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼大厅' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼分诊台' AND floor_level = 1),
    2.0, 3, TRUE, '大厅到分诊台'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼大厅' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼分诊台' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼分诊台' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼1楼主走廊' AND floor_level = 1),
    3.0, 4, TRUE, '分诊台到主走廊'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼分诊台' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼1楼主走廊' AND floor_level = 1);

-- 儿科楼内部连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼大门' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼大厅' AND floor_level = 1),
    2.0, 3, TRUE, '大门到大厅'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼大门' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼大厅' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼大厅' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼分诊台' AND floor_level = 1),
    2.0, 3, TRUE, '大厅到分诊台'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼大厅' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼分诊台' AND floor_level = 1);

-- 妇产科楼内部连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼大门' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼大厅' AND floor_level = 1),
    2.0, 3, TRUE, '大门到大厅'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼大门' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼大厅' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼大厅' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼分诊台' AND floor_level = 1),
    2.0, 3, TRUE, '大厅到分诊台'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼大厅' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼分诊台' AND floor_level = 1);

-- 5. 连接各楼栋之间的路径（从医院正门到各楼栋）
-- 医院正门 -> 中心广场
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '医院正门' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1),
    10.0, 15, TRUE, '正门到中心广场'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '医院正门' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1);

-- 中心广场 -> 各楼栋路口
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼路口' AND floor_level = 1),
    5.0, 8, TRUE, '中心广场到内科楼路口'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼路口' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼路口' AND floor_level = 1),
    5.0, 8, TRUE, '中心广场到外科楼路口'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼路口' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼路口' AND floor_level = 1),
    5.0, 8, TRUE, '中心广场到儿科楼路口'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼路口' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼路口' AND floor_level = 1),
    5.0, 8, TRUE, '中心广场到妇产科楼路口'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '中心广场' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼路口' AND floor_level = 1);

-- 各楼栋路口 -> 对应楼栋大门
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼路口' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '内科楼大门' AND floor_level = 1),
    8.0, 12, TRUE, '路口到内科楼大门'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼路口' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '内科楼大门' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼路口' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '外科楼大门' AND floor_level = 1),
    8.0, 12, TRUE, '路口到外科楼大门'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼路口' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '外科楼大门' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼路口' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '儿科楼大门' AND floor_level = 1),
    8.0, 12, TRUE, '路口到儿科楼大门'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼路口' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '儿科楼大门' AND floor_level = 1);

INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼路口' AND floor_level = 1),
    (SELECT node_id FROM map_nodes WHERE node_name = '妇产科楼大门' AND floor_level = 1),
    8.0, 12, TRUE, '路口到妇产科楼大门'
WHERE EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼路口' AND floor_level = 1)
  AND EXISTS (SELECT 1 FROM map_nodes WHERE node_name = '妇产科楼大门' AND floor_level = 1);

-- 6. 连接电梯/楼梯到主走廊
-- 内科楼电梯/楼梯连接
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('内科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level),
    3.0, 4, TRUE, '电梯/楼梯到主走廊'
FROM map_nodes n
WHERE n.node_type IN ('elevator', 'stairs')
  AND n.node_name LIKE '内科楼%'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('内科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- 外科楼电梯/楼梯连接（类似）
INSERT IGNORE INTO `map_edges` (`start_node_id`, `end_node_id`, `distance`, `walk_time`, `is_bidirectional`, `accessibility_info`)
SELECT 
    n.node_id,
    (SELECT node_id FROM map_nodes 
     WHERE node_name = CONCAT('外科楼', n.floor_level, '楼主走廊') 
     AND floor_level = n.floor_level),
    3.0, 4, TRUE, '电梯/楼梯到主走廊'
FROM map_nodes n
WHERE n.node_type IN ('elevator', 'stairs')
  AND n.node_name LIKE '外科楼%'
  AND EXISTS (SELECT 1 FROM map_nodes 
              WHERE node_name = CONCAT('外科楼', n.floor_level, '楼主走廊') 
              AND floor_level = n.floor_level);

-- ============================================
-- 第七部分：更新二维码内容
-- ============================================

UPDATE `map_nodes` 
SET 
    `qrcode_content` = CONCAT('HOSPITAL_NODE_', `node_id`),
    `qrcode_status` = 'active',
    `qrcode_generated_at` = NOW()
WHERE `qrcode_content` IS NULL OR `qrcode_content` = '';

-- ============================================
-- 第八部分：数据验证和统计
-- ============================================

-- 1. 查看诊室创建情况
SELECT 
    '诊室统计' AS 类别,
    COUNT(*) AS 总数,
    COUNT(DISTINCT department_id) AS 涉及科室数,
    GROUP_CONCAT(DISTINCT building ORDER BY building) AS 楼栋分布
FROM locations;

-- 2. 查看各楼栋诊室分布
SELECT 
    building AS 楼栋,
    COUNT(*) AS 诊室数量,
    COUNT(DISTINCT department_id) AS 科室数量,
    GROUP_CONCAT(DISTINCT location_name ORDER BY location_name SEPARATOR ', ') AS 诊室列表
FROM locations 
GROUP BY building 
ORDER BY 
    CASE building
        WHEN '内科楼' THEN 1
        WHEN '外科楼' THEN 2
        WHEN '儿科楼' THEN 3
        WHEN '妇产科楼' THEN 4
        ELSE 5
    END;

-- 3. 查看地图节点统计
SELECT 
    '地图节点统计' AS 类别,
    COUNT(*) AS 节点总数,
    SUM(CASE WHEN node_type = 'room' THEN 1 ELSE 0 END) AS 诊室节点数,
    SUM(CASE WHEN node_type = 'hallway' THEN 1 ELSE 0 END) AS 走廊节点数,
    SUM(CASE WHEN node_type = 'elevator' THEN 1 ELSE 0 END) AS 电梯节点数,
    SUM(CASE WHEN node_type = 'stairs' THEN 1 ELSE 0 END) AS 楼梯节点数,
    SUM(CASE WHEN node_type = 'entrance' THEN 1 ELSE 0 END) AS 入口节点数
FROM map_nodes;

-- 4. 查看路径连接统计
SELECT 
    '路径连接统计' AS 类别,
    COUNT(*) AS 总连接数,
    COUNT(DISTINCT start_node_id) AS 涉及起始节点数,
    COUNT(DISTINCT end_node_id) AS 涉及结束节点数,
    GROUP_CONCAT(DISTINCT accessibility_info ORDER BY accessibility_info SEPARATOR ', ') AS 连接类型
FROM map_edges;

-- 5. 查看各楼栋内部连接情况
SELECT 
    '内科楼内部连接' AS 楼栋,
    COUNT(*) AS 连接数
FROM map_edges e
JOIN map_nodes n1 ON e.start_node_id = n1.node_id
WHERE n1.node_name LIKE '内科楼%'
UNION ALL
SELECT 
    '外科楼内部连接',
    COUNT(*)
FROM map_edges e
JOIN map_nodes n1 ON e.start_node_id = n1.node_id
WHERE n1.node_name LIKE '外科楼%'
UNION ALL
SELECT 
    '儿科楼内部连接',
    COUNT(*)
FROM map_edges e
JOIN map_nodes n1 ON e.start_node_id = n1.node_id
WHERE n1.node_name LIKE '儿科楼%'
UNION ALL
SELECT 
    '妇产科楼内部连接',
    COUNT(*)
FROM map_edges e
JOIN map_nodes n1 ON e.start_node_id = n1.node_id
WHERE n1.node_name LIKE '妇产科楼%'
UNION ALL
SELECT 
    '楼栋间连接',
    COUNT(*)
FROM map_edges e
JOIN map_nodes n1 ON e.start_node_id = n1.node_id
WHERE n1.node_name IN ('医院正门', '中心广场', '内科楼路口', '外科楼路口', '儿科楼路口', '妇产科楼路口');

-- 6. 查看完整的科室-诊室对应关系
SELECT 
    pd.name AS 父科室,
    d.name AS 子科室,
    l.location_name AS 诊室名称,
    l.building AS 所在楼栋,
    l.floor_level AS 楼层,
    l.room_number AS 房间号
FROM departments d
JOIN parent_departments pd ON d.parent_id = pd.parent_department_id
JOIN locations l ON d.department_id = l.department_id
ORDER BY 
    CASE pd.name
        WHEN '内科' THEN 1
        WHEN '外科' THEN 2
        WHEN '儿科' THEN 3
        WHEN '妇产科' THEN 4
        ELSE 5
    END,
    d.department_id,
    l.location_name;

-- 7. 检查是否有诊室没有正确关联地图节点
SELECT 
    '诊室关联检查' AS 检查项,
    l.location_id AS 诊室ID,
    l.location_name AS 诊室名称,
    l.map_node_id AS 地图节点ID,
    CASE 
        WHEN l.map_node_id IS NULL THEN '❌ 未关联节点'
        WHEN m.node_id IS NULL THEN '❌ 节点不存在'
        ELSE '✅ 正常'
    END AS 状态
FROM locations l
LEFT JOIN map_nodes m ON l.map_node_id = m.node_id
WHERE l.map_node_id IS NULL OR m.node_id IS NULL;

-- 8. 显示各楼栋的楼层分布
SELECT 
    building AS 楼栋,
    floor_level AS 楼层,
    COUNT(*) AS 诊室数量,
    GROUP_CONCAT(location_name ORDER BY location_name SEPARATOR ', ') AS 诊室列表
FROM locations 
GROUP BY building, floor_level
ORDER BY 
    CASE building
        WHEN '内科楼' THEN 1
        WHEN '外科楼' THEN 2
        WHEN '儿科楼' THEN 3
        WHEN '妇产科楼' THEN 4
        ELSE 5
    END,
    floor_level;
    
SET SQL_SAFE_UPDATES = 1;