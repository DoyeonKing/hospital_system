# 时间段接口调试指南

## 🔍 问题排查步骤

### 1. 检查后端服务状态
```bash
# 确保后端服务正在运行
curl http://localhost:8080/api/timeslots
```

### 2. 检查浏览器控制台
打开浏览器开发者工具（F12），查看Console标签页的错误信息：

**期望看到的日志：**
```
开始获取时间段数据...
时间段API响应: {code: 200, data: [...]}
时间段数据加载成功: [...]
```

**可能的错误：**
- `Network Error`: 后端服务未启动
- `404 Not Found`: 接口路径错误
- `500 Internal Server Error`: 后端代码错误

### 3. 检查网络请求
在开发者工具的Network标签页中：
1. 刷新页面
2. 查找 `/api/timeslots` 请求
3. 查看请求状态码和响应内容

### 4. 手动测试API
在浏览器控制台中执行：
```javascript
// 测试API调用
fetch('http://localhost:8080/api/timeslots')
  .then(response => response.json())
  .then(data => console.log('API响应:', data))
  .catch(error => console.error('API错误:', error));
```

## 🛠️ 解决方案

### 方案1: 后端服务未启动
```bash
# 启动Spring Boot后端服务
cd springboot
mvn spring-boot:run
```

### 方案2: 数据库中没有时间段数据
在后端数据库中插入测试数据：
```sql
INSERT INTO time_slots (slot_name, start_time, end_time, period) VALUES
('上午08:00-08:30', '08:00:00', '08:30:00', '上午'),
('上午08:30-09:00', '08:30:00', '09:00:00', '上午'),
('上午09:00-09:30', '09:00:00', '09:30:00', '上午'),
('下午14:00-14:30', '14:00:00', '14:30:00', '下午'),
('下午14:30-15:00', '14:30:00', '15:00:00', '下午');
```

### 方案3: 接口路径错误
检查后端Controller是否正确映射：
```java
@RestController
@RequestMapping("/api/timeslots")
public class TimeSlotController {
    @GetMapping
    public ResponseEntity<Result> getAllTimeSlots() {
        // 实现代码
    }
}
```

## 🔧 当前实现的容错机制

我已经在代码中添加了容错机制：

1. **API调用失败时**：自动使用备用时间段数据
2. **网络错误时**：显示警告信息，但不影响页面功能
3. **数据格式错误时**：尝试多种解析方式

## 📊 调试信息输出

代码会在控制台输出以下调试信息：
- `开始获取时间段数据...`
- `时间段API响应: [完整响应对象]`
- `时间段数据加载成功: [时间段数组]`
- 或错误信息

## 🎯 预期结果

成功时，红圈区域应该显示：
- 时间段卡片列表
- 每个卡片包含时钟图标、时间段名称、具体时间
- 支持拖拽到排班表格

失败时，会显示：
- 警告消息："使用默认时间段数据"
- 但时间段卡片仍然正常显示（使用备用数据）

## 🚨 常见问题

1. **CORS错误**: 后端需要配置跨域访问
2. **端口冲突**: 确保8080端口未被占用
3. **数据库连接**: 确保数据库服务正常运行
4. **依赖缺失**: 确保后端项目依赖完整
