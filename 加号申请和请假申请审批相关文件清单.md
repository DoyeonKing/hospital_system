# 加号申请审批和请假申请审批相关文件清单

## 一、加号申请审批功能

### 1. 后端文件（Spring Boot）

#### 1.1 Controller 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/controller/SlotApplicationController.java`
- **功能**: 处理加号申请的HTTP请求，包括创建、查询、审批等接口

#### 1.2 Service 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/service/SlotApplicationService.java`
- **功能**: 加号申请的业务逻辑处理，包括申请创建、审批流程、状态更新等

- **文件路径**: `springboot/src/main/java/com/example/springboot/service/AddOnSlotService.java`
- **功能**: 加号号源管理服务，处理加号的创建和分配

#### 1.3 Repository 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/repository/SlotApplicationRepository.java`
- **功能**: 加号申请数据访问层，提供数据库操作接口

#### 1.4 Entity 实体类
- **文件路径**: `springboot/src/main/java/com/example/springboot/entity/SlotApplication.java`
- **功能**: 加号申请实体类，对应数据库表 slot_application

#### 1.5 枚举类
- **文件路径**: `springboot/src/main/java/com/example/springboot/entity/enums/SlotApplicationStatus.java`
- **功能**: 加号申请状态枚举（PENDING, APPROVED, REJECTED, CANCELLED）

#### 1.6 DTO 数据传输对象
- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/slotapplication/SlotApplicationCreateRequest.java`
- **功能**: 创建加号申请的请求对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/slotapplication/SlotApplicationUpdateRequest.java`
- **功能**: 更新加号申请的请求对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/slotapplication/SlotApplicationResponse.java`
- **功能**: 加号申请的响应对象

### 2. 前端文件（Vue）

#### 2.1 医生端（患者申请加号）
- **文件路径**: `vue/src/views/SlotApplication.vue`
- **功能**: 医生申请加号的页面

- **文件路径**: `vue/src/api/slotApplication.js`
- **功能**: 加号申请相关的API接口封装

#### 2.2 管理员端（审批加号申请）
- **文件路径**: `vue_admin/src/views/SlotApproval.vue`
- **功能**: 管理员审批加号申请的页面，包括查看申请列表、审批操作等

- **文件路径**: `vue_admin/src/api/slotApplication.js`
- **功能**: 管理员端加号申请相关的API接口封装

### 3. 数据库相关

#### 3.1 建表语句
- **文件路径**: `sql语句/修改语句/14_create_slot_application_table.sql`
- **功能**: 创建 slot_application 表的SQL语句

#### 3.2 字段添加
- **文件路径**: `sql语句/修改语句/15_add_add_on_fields.sql`
- **功能**: 添加加号相关字段到现有表

#### 3.3 验证脚本
- **文件路径**: `sql语句/修改语句/16_verify_add_on_fields.sql`
- **功能**: 验证加号相关字段是否正确添加

#### 3.4 测试脚本
- **文件路径**: `sql语句/加号功能测试脚本.sql`
- **功能**: 加号功能的测试数据和测试SQL

### 4. 文档说明
- **文件路径**: `加号功能实现完成总结.md`
- **功能**: 加号功能实现的完整总结文档

- **文件路径**: `加号批准功能实现说明.md`
- **功能**: 加号批准功能的详细实现说明

- **文件路径**: `加号审批代码优化说明.md`
- **功能**: 加号审批代码的优化说明

- **文件路径**: `批准状态不更新问题修复.md`
- **功能**: 批准状态更新问题的修复说明

- **文件路径**: `sql语句/修改语句/加号功能实施指南.md`
- **功能**: 加号功能的实施指南

---

## 二、请假申请审批功能

### 1. 后端文件（Spring Boot）

#### 1.1 Controller 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/controller/LeaveRequestController.java`
- **功能**: 处理请假申请的HTTP请求，包括创建、查询、审批等接口

#### 1.2 Service 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/service/LeaveRequestService.java`
- **功能**: 请假申请的业务逻辑处理，包括申请创建、审批流程、代班医生分配等

- **文件路径**: `springboot/src/main/java/com/example/springboot/service/NotificationService.java`
- **功能**: 通知服务，处理请假申请相关的通知推送

#### 1.3 Repository 层
- **文件路径**: `springboot/src/main/java/com/example/springboot/repository/LeaveRequestRepository.java`
- **功能**: 请假申请数据访问层，提供数据库操作接口

#### 1.4 Entity 实体类
- **文件路径**: `springboot/src/main/java/com/example/springboot/entity/LeaveRequest.java`
- **功能**: 请假申请实体类，对应数据库表 leave_request

#### 1.5 枚举类
- **文件路径**: `springboot/src/main/java/com/example/springboot/entity/enums/LeaveRequestStatus.java`
- **功能**: 请假申请状态枚举

#### 1.6 转换器
- **文件路径**: `springboot/src/main/java/com/example/springboot/converter/LeaveRequestStatusConverter.java`
- **功能**: 请假申请状态的JPA转换器

#### 1.7 DTO 数据传输对象
- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/leaverequest/LeaveRequestCreateRequest.java`
- **功能**: 创建请假申请的请求对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/leaverequest/LeaveRequestUpdateRequest.java`
- **功能**: 更新请假申请的请求对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/leaverequest/LeaveRequestResponse.java`
- **功能**: 请假申请的响应对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/leaverequest/LeaveApprovalDetailResponse.java`
- **功能**: 请假审批详情的响应对象

- **文件路径**: `springboot/src/main/java/com/example/springboot/dto/leaverequest/SubstituteConfirmRequest.java`
- **功能**: 代班医生确认的请求对象

### 2. 前端文件（Vue）

#### 2.1 医生端（申请请假）
- **文件路径**: `vue/src/views/LeaveRequest.vue`
- **功能**: 医生申请请假的页面

- **文件路径**: `vue/src/api/leave.js`
- **功能**: 请假申请相关的API接口封装

#### 2.2 管理员端（审批请假申请）
- **文件路径**: `vue_admin/src/views/LeaveApproval.vue`
- **功能**: 管理员审批请假申请的页面，包括查看申请列表、选择代班医生、审批操作等

- **文件路径**: `vue_admin/src/views/SubstituteSelection.vue`
- **功能**: 代班医生选择页面

- **文件路径**: `vue_admin/src/api/leave.js`
- **功能**: 管理员端请假申请相关的API接口封装

### 3. 系统设计文档
- **文件路径**: `vue_admin/系统设计图/6_时序图_医生请假流程.puml`
- **功能**: 医生请假流程的时序图（PlantUML格式）

---

## 三、核心功能对比

| 功能模块 | 加号申请审批 | 请假申请审批 |
|---------|------------|------------|
| **申请人** | 医生 | 医生 |
| **审批人** | 管理员 | 管理员 |
| **核心业务** | 为医生增加额外的号源 | 医生请假，需要安排代班医生 |
| **状态流转** | PENDING → APPROVED/REJECTED | PENDING → APPROVED/REJECTED |
| **特殊处理** | 审批通过后创建加号号源 | 审批通过后分配代班医生，更新排班 |
| **数据库表** | slot_application | leave_request |
| **关联表** | schedules, appointments | schedules, doctors |

---

## 四、文件使用说明

### 如何查看这些文件：

1. **后端代码**：使用 IntelliJ IDEA 或其他 Java IDE 打开 `springboot` 目录
2. **前端代码**：使用 VS Code 或其他编辑器打开 `vue` 和 `vue_admin` 目录
3. **数据库脚本**：使用数据库管理工具（如 MySQL Workbench）打开 `sql语句` 目录下的 SQL 文件
4. **文档说明**：使用 Markdown 编辑器或文本编辑器查看 `.md` 文件

### 关键接口：

#### 加号申请审批接口：
- `POST /api/slot-applications` - 创建加号申请
- `GET /api/slot-applications` - 查询加号申请列表
- `GET /api/slot-applications/{id}` - 查询单个加号申请详情
- `PUT /api/slot-applications/{id}/approve` - 批准加号申请
- `PUT /api/slot-applications/{id}/reject` - 拒绝加号申请

#### 请假申请审批接口：
- `POST /api/leave-requests` - 创建请假申请
- `GET /api/leave-requests` - 查询请假申请列表
- `GET /api/leave-requests/{id}` - 查询单个请假申请详情
- `PUT /api/leave-requests/{id}/approve` - 批准请假申请
- `PUT /api/leave-requests/{id}/reject` - 拒绝请假申请
- `GET /api/leave-requests/{id}/approval-detail` - 获取审批详情（包括代班医生信息）

---

## 五、快速定位指南

### 如果要修改审批逻辑：
- **加号申请**: 修改 `SlotApplicationService.java` 中的 `approveApplication()` 方法
- **请假申请**: 修改 `LeaveRequestService.java` 中的 `approveLeaveRequest()` 方法

### 如果要修改审批页面：
- **加号申请**: 修改 `vue_admin/src/views/SlotApproval.vue`
- **请假申请**: 修改 `vue_admin/src/views/LeaveApproval.vue`

### 如果要修改数据库结构：
- **加号申请**: 参考 `sql语句/修改语句/14_create_slot_application_table.sql`
- **请假申请**: 查看 `leave_request` 表的建表语句（在初始建表脚本中）

---

**注意**: 以上所有文件路径都是相对于项目根目录 `d:\BJTU5\hospital_system\` 的相对路径。
